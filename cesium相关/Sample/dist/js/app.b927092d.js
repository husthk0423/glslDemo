(function(e){function t(t){for(var a,s,o=t[0],l=t[1],u=t[2],h=0,d=[];h<o.length;h++)s=o[h],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&d.push(r[s][0]),r[s]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);c&&c(t);while(d.length)d.shift()();return n.push.apply(n,u||[]),i()}function i(){for(var e,t=0;t<n.length;t++){for(var i=n[t],a=!0,o=1;o<i.length;o++){var l=i[o];0!==r[l]&&(a=!1)}a&&(n.splice(t--,1),e=s(s.s=i[0]))}return e}var a={},r={app:0},n=[];function s(t){if(a[t])return a[t].exports;var i=a[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=a,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(i,a,function(t){return e[t]}.bind(null,a));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=l;n.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},2573:function(e,t,i){"use strict";i("aef6")},4942:function(e,t){var i=16;function a(){var e=document.documentElement.clientWidth/1920;document.documentElement.style.fontSize=i*Math.min(e,2)+"px"}a(),window.onresize=function(){a()}},"4e22":function(e,t,i){"use strict";i("8c40")},"56d7":function(e,t,i){"use strict";i.r(t);i("6da3"),i("dea3"),i("da68"),i("1311");var a=i("2c46"),r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},n=[],s={name:"app"},o=s,l=i("cba8"),u=Object(l["a"])(o,r,n,!1,null,null,null),c=u.exports,h=i("ac56"),d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("cesium-map")},m=[],p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("div",{staticClass:"btn"},[i("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.toBuild}},[e._v("查看楼栋信息")])],1),i("div",{attrs:{id:"cesiumContainer"}}),e.showBuild?i("build-table",{attrs:{features:e.features}}):e._e()],1)},f=[],y=i("febe"),v=i("2a8b");i("e186"),i("51b3"),i("10dd");function g(e,t,i){i&&i.destroy();var a='\n        <div class="gif-popDiv">\n          <div class="gif-div">\n            <div class="gif-text">'.concat(t.name,"</div>\n          </div>\n        </div>"),r=a,n=$(r)[0],s={element:n,position:t.position,offset:{x:0,y:0}};return i=new Custom.Overlay(s),e.addOverlay(i),window.closePopDiv=function(){i.destroy()},i}var b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"build-div"},[i("div",{staticClass:"header"},[e._v("楼宇信息列表")]),i("div",{staticClass:" table-class",staticStyle:{height:"20rem",opacity:"0.8"}},[e._m(0),i("el-table",{staticClass:"build-table",attrs:{data:e.levelData,height:"300",stripe:""},on:{"cell-click":e.cellClick}},[i("el-table-column",{attrs:{prop:"floorNumber",label:"层数",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(" "+e._s(t.row.floorNumber))])]}}])}),i("el-table-column",{attrs:{prop:"floorArea",label:"层总面积",align:"center"}}),i("el-table-column",{attrs:{prop:"houseHold",label:"层户数",align:"center"}})],1)],1),e._m(1),i("div",{staticClass:"leaflet-map"},[i("leaflet-map",{staticStyle:{opacity:"0.8"},attrs:{id:"map"},on:{clickLMap:e.clickLMap}})],1),i("div",{staticClass:"table-class",staticStyle:{opacity:"0.8"}},[e._m(2),i("el-table",{staticClass:"build-table",attrs:{data:e.tableData}},[i("el-table-column",{attrs:{prop:"QLR",label:"户主",align:"center"}}),i("el-table-column",{attrs:{prop:"HZL",label:"具体位置",align:"center"}}),i("el-table-column",{attrs:{prop:"BDCDYH",label:"不动产编号",align:"center"}})],1)],1)])},w=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"box-title"},[i("span",[e._v("楼层信息")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"box-title"},[i("span",[e._v("户型图")])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"box-title"},[i("span",[e._v("户详情")])])}],C=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticStyle:{width:"100%",height:"100%","z-index":"10","background-color":"rgba(0,0,0,0.7)"},attrs:{id:e.id}},[i("div",{staticStyle:{position:"absolute",bottom:"0px",left:"0px","z-index":"1000"},attrs:{id:"info"}})])},S=[],M=(i("8ea3"),i("89a8"),i("1a91"),{data:function(){return{layerMap:{},mapJSon:null,map:null,geoJsonLayer:null}},watch:{layerList:function(e){this.removeAllLayer(),this.addLayers(e)}},props:{id:{type:String,required:!0},layerList:{type:Array,default:function(){return[]}},mapOption:{type:Object,default:function(){return{}}},createMap:Function,needImage:{type:Boolean,default:!0}},created:function(){},mounted:function(){this.addListen(),this.initMap()},methods:{initMap:function(){var e={minZoom:this.mapOption.hasOwnProperty("minZoom")||0,maxZoom:this.mapOption.hasOwnProperty("maxZoom")||20,center:{lon:window.leafletMap.center.lon,lat:window.leafletMap.center.lat},zoom:this.mapOption.hasOwnProperty("zoom")||window.leafletMap.level,crs:this.mapOption.hasOwnProperty("crs")||L.CRS.CustomEPSG4326,zoomControl:!1,attributionControl:!1};this.map=L.map(this.id,e),this.setGeojson()},addListen:function(){this.eventBus.$on("setBaseLayerUrl",this.setBaseLayerUrl),this.eventBus.$on("addLayer",this.addLayer),this.eventBus.$on("removeLayer",this.removeLayer),this.eventBus.$on("updateOpacity",this.updateOpacity),this.eventBus.$on("updateLayerIndex",this.updateLayerIndex),this.eventBus.$on("showLayer",this.showLayer),this.eventBus.$on("hideLayer",this.hideLayer),this.eventBus.$on("flyTo",this.flyTo),this.eventBus.$on("setGeojson",this.setGeojson),this.eventBus.$on("removeGeoJson",this.removeGeoJson)},removeListen:function(){this.eventBus.$off("setBaseLayerUrl",this.setBaseLayerUrl),this.eventBus.$off("addLayer",this.addLayer),this.eventBus.$off("removeLayer",this.removeLayer),this.eventBus.$off("updateOpacity",this.updateOpacity),this.eventBus.$off("updateLayerIndex",this.updateLayerIndex),this.eventBus.$off("showLayer",this.showLayer),this.eventBus.$off("hideLayer",this.hideLayer),this.eventBus.$off("flyTo",this.flyTo),this.eventBus.$off("setGeojson",this.setGeojson),this.eventBus.$off("removeGeoJson",this.removeGeoJson)},setGeojson:function(e){var t=this;return Object(y["a"])(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.geoJsonLayer&&t.map.removeLayer(t.geoJsonLayer),e.next=3,t.$get("data/hu.geojson");case 3:i=e.sent,L.geoJSON(i,{style:function(e){return{fillColor:"blue"}}}).on("click",(function(e){var i=e.layer.feature,a=i.properties,r=[];i.geometry.coordinates[0].forEach((function(e){r.push(e[0],e[1])})),i.arr=r,t.$emit("clickLMap",i,a)})).addTo(t.map);case 5:case"end":return e.stop()}}),e)})))()},removeGeoJson:function(){this.geoJsonLayer&&this.map.removeLayer(this.geoJsonLayer)},flyTo:function(e,t){this.map.flyTo([t,e])},addLayers:function(e){for(var t=0;t<e.length;t++){var i=e[t];this.addLayer(i)}this.$emit("createMap",this.layerMap)},addLayer:function(e){switch(e.layerType){case"WMTS":this.addWMTSLayer(e);break;case"WMS":this.addWMSLayer(e);break;case"VTS":this.addVTSLayer(e);break}},addBaseLayer:function(){if(this.baseLayer=new L.TileLayer(window.leafletMap.baseMapImageUrl,{tileSize:256}),this.map.addLayer(this.baseLayer),window.leafletMap.mapBoundary){var e=new L.TileLayer(window.leafletMap.mapBoundary,{tileSize:256});this.map.addLayer(e),e.setZIndex(100)}},addBaseLabel:function(){var e=new L.GWVTAnno({tileSize:512,debug:!1}),t=new Custom.URLDataSource;t.url=window.leafletMap.baseLabelUrl,e.addDataSource(t),this.map.addLayer(e)},setBaseLayerUrl:function(e){if(this.baseLayer){this.baseLayer.setUrl(e,!0);var t=new L.TileLayer(e,{tileSize:256});this.map.addLayer(t)}},addWMTSLayer:function(e){var t=e.layerUrl+"&tilesize=256",i=new L.TileLayer(t,{tileSize:256});this.map.addLayer(i),i.setZIndex(e.layerIndex),this.layerMap[e.layerId]=i},addWMSLayer:function(e){},addVTSLayer:function(e){},removeLayer:function(e){var t=this.layerMap[e];t&&(this.map.removeLayer(t),delete this.layerMap[e])},updateOpacity:function(e){var t=this.layerMap[e.layerId];t.setOpacity(.01*e.opacity)},updateLayerIndex:function(e){for(var t=0;t<e.length;t++){var i=e[t],a=this.layerMap[i.layerId],r=i.layerIndex;a.setZIndex(r)}},showLayer:function(e){var t=this.layerMap[e];t&&(this.map.addLayer(t),t.setZIndex(t.zIndex))},hideLayer:function(e){var t=this.layerMap[e];if(t&&t.hasOwnProperty("_container")){var i=t._container.style.zIndex;t.zIndex=i,this.map.removeLayer(t)}},removeAllLayer:function(){for(var e in this.layerMap)this.removeLayer(e)}},destroyed:function(){this.removeListen()}}),x=M,T=(i("7c41"),Object(l["a"])(x,C,S,!1,null,null,null)),I=T.exports,_={data:function(){return{show:!1,levelData:[],buildNum:1,height:0,tableData:[],feature:null}},props:{features:{type:Array}},methods:{clickLMap:function(e,t){t&&(this.tableData=[],this.tableData.push(t)),this.highHuLayer&&this.Global.viewer.scene.primitives.remove(this.highHuLayer),this.highHuLayer=new Cesium.ClassificationPrimitive({geometryInstances:[],classificationType:Cesium.ClassificationType.CESIUM_3D_TILE,asynchronous:!1,appearance:new Cesium.PerInstanceColorAppearance({closed:!0,translucent:!0})});var i=new Cesium.GeometryInstance({id:1,geometry:Cesium.PolygonGeometry.fromPositions({positions:Cesium.Cartesian3.fromDegreesArray(e.arr),height:this.height,extrudedHeight:this.height+2.5,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString("#6495ED").withAlpha(.8))}});this.highHuLayer.geometryInstances.push(i),this.Global.viewer.scene.primitives.add(this.highHuLayer)},cellClick:function(e,t,i,a){var r=2.5*(e.floorNumber-1)+22;this.highGateway(r),this.buildNum=e.floorNumber,this.tableData=[]},highGateway:function(e){this.highLayer&&this.Global.viewer.scene.primitives.remove(this.highLayer),this.highHuLayer&&this.Global.viewer.scene.primitives.remove(this.highHuLayer),this.highLayer=new Cesium.ClassificationPrimitive({geometryInstances:[],classificationType:Cesium.ClassificationType.CESIUM_3D_TILE,asynchronous:!1,appearance:new Cesium.PerInstanceColorAppearance({closed:!0,translucent:!0})});var t=new Cesium.GeometryInstance({id:1,geometry:Cesium.PolygonGeometry.fromPositions({positions:Cesium.Cartesian3.fromDegreesArray(this.features[0].arr),height:e,extrudedHeight:e+2.5,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString("#ff0000").withAlpha(.6))}});this.height=e,this.highLayer.geometryInstances.push(t),this.Global.viewer.scene.primitives.add(this.highLayer)},getTableData:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("data/fw.json");case 2:i=t.sent,e.levelData=i.buildInfo,e.setDefault();case 5:case"end":return t.stop()}}),t)})))()},setDefault:function(){var e=34.5;this.highGateway(e),this.buildNum=6}},created:function(){this.defaultLayer=null,this.highLayer=null,this.highHuLayer=null,this.getTableData()},components:{leafletMap:I}},O=_,P=(i("4e22"),Object(l["a"])(O,b,w,!1,null,null,null)),B=P.exports,D={name:"Home",data:function(){return Object(v["a"])({features:[],dataObj:[],showBuildDetail:!1,showBuild:!1,nodeData:{}},"features",[])},methods:{toBuild:function(){this.showBuild=!0,this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(118.93710790118006,31.36193873971865,214.49127761587422),orientation:{heading:Cesium.Math.toRadians(333.78043755071064),pitch:Cesium.Math.toRadians(-36.7874088381728),roll:Cesium.Math.toRadians(.0009088486403607873)}})},creteMap:function(){var e=this,t=new Cesium.CesiumTerrainProvider({url:window.DXUrl});this.viewer=new Cesium.Viewer("cesiumContainer",{terrainProvider:t,contextOptions:{webgl:{alpha:!0,depth:!0,stencil:!1,antialias:!0}},useBrowserRecommendedResolution:!1,homeButton:!1,selectionIndicator:!1,animation:!1,baseLayerPicker:!1,geocoder:!1,timeline:!1,sceneModePicker:!1,navigationHelpButton:!1,infoBox:!1,imageryProvider:!1,fullscreenButton:!1}),this.scene=this.viewer.scene,this.handler=new Cesium.ScreenSpaceEventHandler(this.viewer.canvas),this.Global.viewer=this.viewer,this.Global.handler=this.handler,this.viewer.scene.globe.depthTestAgainstTerrain=!1,this.viewer.scene.primitives.destroyPrimitives=!1,this.viewer.scene.postProcessStages._fxaa.enabled=!0;var i=this.viewer.scene.postProcessStages;this.viewer.scene.brightness=this.viewer.scene.brightness||i.add(Cesium.PostProcessStageLibrary.createBrightnessStage()),this.viewer.scene.brightness.enabled=!0,this.viewer.scene.brightness.uniforms.brightness=Number(1),this.imageLayer=new Cesium.ImageryLayer(new Cesium.WebMapTileServiceImageryProvider({url:window.imageUrl,layer:"tdtImg_c",style:"default",format:"tiles",tileMatrixSetID:"c",subdomains:["t0","t1","t2","t3","t4","t5","t6","t7"],tilingScheme:new Cesium.GeographicTilingScheme,tileMatrixLabels:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],maximumLevel:18})),this.viewer.imageryLayers.add(this.imageLayer),this.imageLabelLayer=new Cesium.ImageryLayer(new Cesium.WebMapTileServiceImageryProvider({url:window.imageLabelurl,layer:"tdtImg_c",style:"default",format:"tiles",tileMatrixSetID:"c",subdomains:["t0","t1","t2","t3","t4","t5","t6","t7"],tilingScheme:new Cesium.GeographicTilingScheme,tileMatrixLabels:["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],maximumLevel:18})),this.viewer.imageryLayers.add(this.imageLabelLayer),this.viewer.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(118.93791126541784,31.35451964032002,499.9899843559913),orientation:{heading:Cesium.Math.toRadians(359.99999999999613),pitch:Cesium.Math.toRadians(-28.6720574011962),roll:Cesium.Math.toRadians(1.7302209999999265)}}),this.tile3d=new Cesium.Cesium3DTileset({url:window.tileUrl,showFS:!1,showVS:!1}),this.viewer.scene.primitives.add(this.tile3d);var a=new Cesium.ScreenSpaceEventHandler(this.scene.canvas);a.setInputAction((function(t){e.scene.pick(t.position);var i=e.viewer.scene.pickPosition(t.position);console.log(i);var a=e.viewer.scene.globe.ellipsoid,r=a.cartesianToCartographic(i),n=Cesium.Math.toDegrees(r.latitude),s=Cesium.Math.toDegrees(r.longitude),o=r.height;console.log(n,s,o)}),Cesium.ScreenSpaceEventType.LEFT_CLICK),this.viewer.scene.globe.preloadAncestors=!1,this.viewer.scene.globe.baseColor=Cesium.Color.BLACK},loadData:function(){var e=this;return Object(y["a"])(regeneratorRuntime.mark((function t(){var i,a,r,n,s,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$get("data/2.json");case 2:for(i=t.sent,e.features=i.features,e.dataObj=[],a=0;a<e.features.length;a++){for(e.dataObj.push(e.features[a].attributes),r=e.features[a],n=r.geometry.rings[0],s=[],o=0;o<n.length;o++)l=n[o],s.push(l[0],l[1]);r.arr=s}e.add(e.features);case 7:case"end":return t.stop()}}),t)})))()},add:function(e){for(var t=0;t<e.length;t++){this.polygonPrimitive[t]=new Cesium.ClassificationPrimitive({geometryInstances:[],classificationType:Cesium.ClassificationType.CESIUM_3D_TILE,asynchronous:!1,appearance:new Cesium.PerInstanceColorAppearance({closed:!0,translucent:!0})});var i=e[t],a=new Cesium.GeometryInstance({id:i.attributes.OBJECTID,geometry:Cesium.PolygonGeometry.fromPositions({positions:Cesium.Cartesian3.fromDegreesArray(i.arr),height:25,extrudedHeight:75,vertexFormat:Cesium.EllipsoidSurfaceAppearance.VERTEX_FORMAT}),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(Cesium.Color.fromCssColorString("#ff0000").withAlpha(0))}});this.polygonPrimitive[t].geometryInstances.push(a),this.scene.primitives.add(this.polygonPrimitive[t])}},loadPop:function(){var e={name:"桃园雅居四区3栋",postion:{x:-2637438.1835306305,y:4770810.766551753,z:3300178.7620727895}};this.popDivLayer=g(this.viewer,e,this.popDivLayer)}},created:function(){this.viewer=null,this.scene=null,this.imageLayer=null,this.imageLabelLayer=null,this.tile3d=null,this.polygonPrimitive=[],this.popDivLayer=null},mounted:function(){this.creteMap(),this.loadData()},components:{buildTable:B}},G=D,j=(i("2573"),Object(l["a"])(G,p,f,!1,null,null,null)),E=j.exports,A={components:{cesiumMap:E}},k=A,R=Object(l["a"])(k,d,m,!1,null,null,null),z=R.exports;a["default"].use(h["a"]);var H=[{path:"/",name:"首页",component:z,children:[]}],U=new h["a"]({mode:"hash",base:"",routes:H}),J=U,W=i("7736");a["default"].use(W["a"]);var F=new W["a"].Store({state:{},mutations:{},actions:{},modules:{}}),N=i("5422"),V=i.n(N),Z=(i("e9b7"),i("4942"),i("4ff3")),X=i.n(Z),q=X.a.create({baseURL:"",timeout:3e4});q.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),q.interceptors.response.use((function(e){var t=e.data.code;return"500"===t&&console.log(500),e}),(function(e){return console.log(e),Promise.reject(e)}));function K(e,t){return new Promise((function(i,a){q.get(e,{params:t}).then((function(e){i(e.data)})).catch((function(e){a(e)}))}))}a["default"].config.productionTip=!1,a["default"].prototype.Global={},a["default"].prototype.eventBus=new a["default"],a["default"].use(V.a,{size:"small"}),a["default"].prototype.$get=K,new a["default"]({router:J,store:F,render:function(e){return e(c)}}).$mount("#app")},"7c41":function(e,t,i){"use strict";i("d998")},"8c40":function(e,t,i){},aef6:function(e,t,i){},d998:function(e,t,i){}});