define(["./Cartesian2-cce28994","./combine-0897f2e3","./AttributeCompression-dc008507","./Math-29cbc3fa","./IndexDatatype-2503dc5a","./Rectangle-1bad9972","./createTaskProcessorWorker","./Check-edea0f91","./defaultValue-81eec7ed","./ComponentDatatype-c1201c79","./WebGLConstants-1c8239cc","./Matrix4-da4bb68c","./RuntimeError-94b0bf5f","./Matrix2-c857e514","./when-422ea0ae"],(function(a,e,r,t,n,i,s,c,o,u,f,d,p,C,b){"use strict";var l=32767,h=new a.Cartographic,w=new a.Cartesian3;var v=new i.Rectangle,y=new a.Ellipsoid,k=new a.Cartesian3,g={min:void 0,max:void 0};var m=new a.Cartesian3,A=new a.Cartesian3,x=new a.Cartesian3,D=new a.Cartesian3,E=new a.Cartesian3;return s((function(s,c){var o=new Uint16Array(s.positions),u=new Uint16Array(s.widths),f=new Uint32Array(s.counts),d=new Uint16Array(s.batchIds);!function(e){e=new Float64Array(e);var r=0;g.min=e[r++],g.max=e[r++],i.Rectangle.unpack(e,r,v),r+=i.Rectangle.packedLength,a.Ellipsoid.unpack(e,r,y),r+=a.Ellipsoid.packedLength,a.Cartesian3.unpack(e,r,k)}(s.packedBuffer);var p,C=y,b=k,I=function(e,n,i,s,c){var o=e.length/3,u=e.subarray(0,o),f=e.subarray(o,2*o),d=e.subarray(2*o,3*o);r.AttributeCompression.zigZagDeltaDecode(u,f,d);for(var p=new Float64Array(e.length),C=0;C<o;++C){var b=u[C],v=f[C],y=d[C],k=t.CesiumMath.lerp(n.west,n.east,b/l),g=t.CesiumMath.lerp(n.south,n.north,v/l),m=t.CesiumMath.lerp(i,s,y/l),A=a.Cartographic.fromRadians(k,g,m,h),x=c.cartographicToCartesian(A,w);a.Cartesian3.pack(x,p,3*C)}return p}(o,v,g.min,g.max,C),P=I.length/3,R=4*P-4,U=new Float32Array(3*R),M=new Float32Array(3*R),T=new Float32Array(3*R),F=new Float32Array(2*R),N=new Uint16Array(R),L=0,S=0,_=0,G=0,W=f.length;for(p=0;p<W;++p){for(var B=f[p],O=u[p],z=d[p],H=0;H<B;++H){var V;if(0===H){var Y=a.Cartesian3.unpack(I,3*G,m),Z=a.Cartesian3.unpack(I,3*(G+1),A);V=a.Cartesian3.subtract(Y,Z,x),a.Cartesian3.add(Y,V,V)}else V=a.Cartesian3.unpack(I,3*(G+H-1),x);var j,q=a.Cartesian3.unpack(I,3*(G+H),D);if(H===B-1){var J=a.Cartesian3.unpack(I,3*(G+B-1),m),K=a.Cartesian3.unpack(I,3*(G+B-2),A);j=a.Cartesian3.subtract(J,K,E),a.Cartesian3.add(J,j,j)}else j=a.Cartesian3.unpack(I,3*(G+H+1),E);a.Cartesian3.subtract(V,b,V),a.Cartesian3.subtract(q,b,q),a.Cartesian3.subtract(j,b,j);for(var Q=H===B-1?2:4,X=0===H?2:0;X<Q;++X){a.Cartesian3.pack(q,U,L),a.Cartesian3.pack(V,M,L),a.Cartesian3.pack(j,T,L),L+=3;var $=X-2<0?-1:1;F[S++]=X%2*2-1,F[S++]=$*O,N[_++]=z}}G+=B}var aa=n.IndexDatatype.createTypedArray(R,6*P-6),ea=0,ra=0;for(W=P-1,p=0;p<W;++p)aa[ra++]=ea,aa[ra++]=ea+2,aa[ra++]=ea+1,aa[ra++]=ea+1,aa[ra++]=ea+2,aa[ra++]=ea+3,ea+=4;c.push(U.buffer,M.buffer,T.buffer),c.push(F.buffer,N.buffer,aa.buffer);var ta={indexDatatype:2===aa.BYTES_PER_ELEMENT?n.IndexDatatype.UNSIGNED_SHORT:n.IndexDatatype.UNSIGNED_INT,currentPositions:U.buffer,previousPositions:M.buffer,nextPositions:T.buffer,expandAndWidth:F.buffer,batchIds:N.buffer,indices:aa.buffer};if(s.keepDecodedPositions){var na=function(a){for(var e=a.length,r=new Uint32Array(e+1),t=0,n=0;n<e;++n)r[n]=t,t+=a[n];return r[e]=t,r}(f);c.push(I.buffer,na.buffer),ta=e.combine(ta,{decodedPositions:I.buffer,decodedPositionOffsets:na.buffer})}return ta}))}));
