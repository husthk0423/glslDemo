define(["exports","./ArcType-98ec98bf","./GeometryOffsetAttribute-0a70352a","./BoundingSphere-2b618cd6","./Check-edea0f91","./ComponentDatatype-c1201c79","./defaultValue-81eec7ed","./Cartesian2-cce28994","./EllipsoidTangentPlane-3ee186ca","./GeometryAttribute-c4e682f4","./GeometryAttributes-32b29525","./GeometryInstance-0944d7d9","./GeometryPipeline-b8be120b","./IndexDatatype-2503dc5a","./Math-29cbc3fa","./PolygonGeometryLibrary-348aa659","./PolygonPipeline-8ba20582"],(function(e,t,i,r,o,n,a,l,y,s,u,p,d,g,c,f,h){"use strict";var m=[],b=[];function P(e,i,r,o,a){var l,d,c=y.EllipsoidTangentPlane.fromPoints(i,e).projectPointsOntoPlane(i,m);h.PolygonPipeline.computeWindingOrder2D(c)===h.WindingOrder.CLOCKWISE&&(c.reverse(),i=i.slice().reverse());var P=i.length,v=0;if(o)for(l=new Float64Array(2*P*3),d=0;d<P;d++){var A=i[d],E=i[(d+1)%P];l[v++]=A.x,l[v++]=A.y,l[v++]=A.z,l[v++]=E.x,l[v++]=E.y,l[v++]=E.z}else{var _=0;if(a===t.ArcType.GEODESIC)for(d=0;d<P;d++)_+=f.PolygonGeometryLibrary.subdivideLineCount(i[d],i[(d+1)%P],r);else if(a===t.ArcType.RHUMB)for(d=0;d<P;d++)_+=f.PolygonGeometryLibrary.subdivideRhumbLineCount(e,i[d],i[(d+1)%P],r);for(l=new Float64Array(3*_),d=0;d<P;d++){var G;a===t.ArcType.GEODESIC?G=f.PolygonGeometryLibrary.subdivideLine(i[d],i[(d+1)%P],r,b):a===t.ArcType.RHUMB&&(G=f.PolygonGeometryLibrary.subdivideRhumbLine(e,i[d],i[(d+1)%P],r,b));for(var H=G.length,L=0;L<H;++L)l[v++]=G[L]}}var T=2*(P=l.length/3),O=g.IndexDatatype.createTypedArray(P,T);for(v=0,d=0;d<P-1;d++)O[v++]=d,O[v++]=d+1;return O[v++]=P-1,O[v++]=0,new p.GeometryInstance({geometry:new s.Geometry({attributes:new u.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:l})}),indices:O,primitiveType:s.PrimitiveType.LINES})})}function v(e,i,r,o,a){var l,d,c=y.EllipsoidTangentPlane.fromPoints(i,e).projectPointsOntoPlane(i,m);h.PolygonPipeline.computeWindingOrder2D(c)===h.WindingOrder.CLOCKWISE&&(c.reverse(),i=i.slice().reverse());var P=i.length,v=new Array(P),A=0;if(o)for(l=new Float64Array(2*P*3*2),d=0;d<P;++d){v[d]=A/3;var E=i[d],_=i[(d+1)%P];l[A++]=E.x,l[A++]=E.y,l[A++]=E.z,l[A++]=_.x,l[A++]=_.y,l[A++]=_.z}else{var G=0;if(a===t.ArcType.GEODESIC)for(d=0;d<P;d++)G+=f.PolygonGeometryLibrary.subdivideLineCount(i[d],i[(d+1)%P],r);else if(a===t.ArcType.RHUMB)for(d=0;d<P;d++)G+=f.PolygonGeometryLibrary.subdivideRhumbLineCount(e,i[d],i[(d+1)%P],r);for(l=new Float64Array(3*G*2),d=0;d<P;++d){var H;v[d]=A/3,a===t.ArcType.GEODESIC?H=f.PolygonGeometryLibrary.subdivideLine(i[d],i[(d+1)%P],r,b):a===t.ArcType.RHUMB&&(H=f.PolygonGeometryLibrary.subdivideRhumbLine(e,i[d],i[(d+1)%P],r,b));for(var L=H.length,T=0;T<L;++T)l[A++]=H[T]}}P=l.length/6;var O=v.length,x=2*(2*P+O),C=g.IndexDatatype.createTypedArray(P+O,x);for(A=0,d=0;d<P;++d)C[A++]=d,C[A++]=(d+1)%P,C[A++]=d+P,C[A++]=(d+1)%P+P;for(d=0;d<O;d++){var D=v[d];C[A++]=D,C[A++]=D+P}return new p.GeometryInstance({geometry:new s.Geometry({attributes:new u.GeometryAttributes({position:new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:l})}),indices:C,primitiveType:s.PrimitiveType.LINES})})}function A(e){var i=e.polygonHierarchy,r=a.defaultValue(e.ellipsoid,l.Ellipsoid.WGS84),o=a.defaultValue(e.granularity,c.CesiumMath.RADIANS_PER_DEGREE),n=a.defaultValue(e.perPositionHeight,!1),y=n&&a.defined(e.extrudedHeight),s=a.defaultValue(e.arcType,t.ArcType.GEODESIC),u=a.defaultValue(e.height,0),p=a.defaultValue(e.extrudedHeight,u);if(!y){var d=Math.max(u,p);p=Math.min(u,p),u=d}this._ellipsoid=l.Ellipsoid.clone(r),this._granularity=o,this._height=u,this._extrudedHeight=p,this._arcType=s,this._polygonHierarchy=i,this._perPositionHeight=n,this._perPositionHeightExtrude=y,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=f.PolygonGeometryLibrary.computeHierarchyPackedLength(i)+l.Ellipsoid.packedLength+8}A.pack=function(e,t,i){return i=a.defaultValue(i,0),i=f.PolygonGeometryLibrary.packPolygonHierarchy(e._polygonHierarchy,t,i),l.Ellipsoid.pack(e._ellipsoid,t,i),i+=l.Ellipsoid.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=a.defaultValue(e._offsetAttribute,-1),t[i]=e.packedLength,t};var E=l.Ellipsoid.clone(l.Ellipsoid.UNIT_SPHERE),_={polygonHierarchy:{}};A.unpack=function(e,t,i){t=a.defaultValue(t,0);var r=f.PolygonGeometryLibrary.unpackPolygonHierarchy(e,t);t=r.startingIndex,delete r.startingIndex;var o=l.Ellipsoid.unpack(e,t,E);t+=l.Ellipsoid.packedLength;var n=e[t++],y=e[t++],s=e[t++],u=1===e[t++],p=1===e[t++],d=e[t++],g=e[t++],c=e[t];return a.defined(i)||(i=new A(_)),i._polygonHierarchy=r,i._ellipsoid=l.Ellipsoid.clone(o,i._ellipsoid),i._height=n,i._extrudedHeight=y,i._granularity=s,i._perPositionHeight=p,i._perPositionHeightExtrude=u,i._arcType=d,i._offsetAttribute=-1===g?void 0:g,i.packedLength=c,i},A.fromPositions=function(e){return new A({polygonHierarchy:{positions:(e=a.defaultValue(e,a.defaultValue.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},A.createGeometry=function(e){var t=e._ellipsoid,o=e._granularity,l=e._polygonHierarchy,y=e._perPositionHeight,u=e._arcType,p=f.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(l,!y,t);if(0!==p.length){var g,m,b,A=[],E=c.CesiumMath.chordLength(o,t.maximumRadius),_=e._height,G=e._extrudedHeight;if(e._perPositionHeightExtrude||!c.CesiumMath.equalsEpsilon(_,G,0,c.CesiumMath.EPSILON2))for(b=0;b<p.length;b++){if((g=v(t,p[b],E,y,u)).geometry=f.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(g.geometry,_,G,t,y),a.defined(e._offsetAttribute)){var H=g.geometry.attributes.position.values.length/3,L=new Uint8Array(H);e._offsetAttribute===i.GeometryOffsetAttribute.TOP?L=i.arrayFill(L,1,0,H/2):(m=e._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,L=i.arrayFill(L,m)),g.geometry.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}A.push(g)}else for(b=0;b<p.length;b++){if((g=P(t,p[b],E,y,u)).geometry.attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(g.geometry.attributes.position.values,_,t,!y),a.defined(e._offsetAttribute)){var T=g.geometry.attributes.position.values.length,O=new Uint8Array(T/3);m=e._offsetAttribute===i.GeometryOffsetAttribute.NONE?0:1,i.arrayFill(O,m),g.geometry.attributes.applyOffset=new s.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}A.push(g)}var x=d.GeometryPipeline.combineInstances(A)[0],C=r.BoundingSphere.fromVertices(x.attributes.position.values);return new s.Geometry({attributes:x.attributes,indices:x.indices,primitiveType:x.primitiveType,boundingSphere:C,offsetAttribute:e._offsetAttribute})}},e.PolygonOutlineGeometry=A}));
