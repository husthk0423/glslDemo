define(["exports","./GeometryOffsetAttribute-0a70352a","./BoundingSphere-2b618cd6","./Cartesian2-cce28994","./ComponentDatatype-c1201c79","./CylinderGeometryLibrary-36b2fe43","./defaultValue-81eec7ed","./Check-edea0f91","./GeometryAttribute-c4e682f4","./GeometryAttributes-32b29525","./IndexDatatype-2503dc5a","./Math-29cbc3fa","./VertexFormat-aef87cc2"],(function(t,e,a,r,n,o,i,s,u,m,d,p,f){"use strict";var l=new r.Cartesian2,y=new r.Cartesian3,c=new r.Cartesian3,b=new r.Cartesian3,v=new r.Cartesian3;function A(t){var e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,r=t.bottomRadius,n=i.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=r,this._vertexFormat=f.VertexFormat.clone(n),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}A.packedLength=f.VertexFormat.packedLength+5,A.pack=function(t,e,a){return a=i.defaultValue(a,0),f.VertexFormat.pack(t._vertexFormat,e,a),a+=f.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};var g,h=new f.VertexFormat,x={vertexFormat:h,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};A.unpack=function(t,e,a){e=i.defaultValue(e,0);var r=f.VertexFormat.unpack(t,e,h);e+=f.VertexFormat.packedLength;var n=t[e++],o=t[e++],s=t[e++],u=t[e++],m=t[e];return i.defined(a)?(a._vertexFormat=f.VertexFormat.clone(r,a._vertexFormat),a._length=n,a._topRadius=o,a._bottomRadius=s,a._slices=u,a._offsetAttribute=-1===m?void 0:m,a):(x.length=n,x.topRadius=o,x.bottomRadius=s,x.slices=u,x.offsetAttribute=-1===m?void 0:m,new A(x))},A.createGeometry=function(t){var s=t._length,f=t._topRadius,A=t._bottomRadius,g=t._vertexFormat,h=t._slices;if(!(s<=0||f<0||A<0||0===f&&0===A)){var x,_=h+h,C=h+_,F=_+_,w=o.CylinderGeometryLibrary.computePositions(s,f,A,h,!0),G=g.st?new Float32Array(2*F):void 0,V=g.normal?new Float32Array(3*F):void 0,D=g.tangent?new Float32Array(3*F):void 0,R=g.bitangent?new Float32Array(3*F):void 0,O=g.normal||g.tangent||g.bitangent;if(O){var T=g.tangent||g.bitangent,L=0,P=0,k=0,M=Math.atan2(A-f,s),z=y;z.z=Math.sin(M);var E=Math.cos(M),N=b,I=c;for(x=0;x<h;x++){var S=x/h*p.CesiumMath.TWO_PI,U=E*Math.cos(S),B=E*Math.sin(S);O&&(z.x=U,z.y=B,T&&(N=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,z,N),N)),g.normal&&(V[L++]=z.x,V[L++]=z.y,V[L++]=z.z,V[L++]=z.x,V[L++]=z.y,V[L++]=z.z),g.tangent&&(D[P++]=N.x,D[P++]=N.y,D[P++]=N.z,D[P++]=N.x,D[P++]=N.y,D[P++]=N.z),g.bitangent&&(I=r.Cartesian3.normalize(r.Cartesian3.cross(z,N,I),I),R[k++]=I.x,R[k++]=I.y,R[k++]=I.z,R[k++]=I.x,R[k++]=I.y,R[k++]=I.z))}for(x=0;x<h;x++)g.normal&&(V[L++]=0,V[L++]=0,V[L++]=-1),g.tangent&&(D[P++]=1,D[P++]=0,D[P++]=0),g.bitangent&&(R[k++]=0,R[k++]=-1,R[k++]=0);for(x=0;x<h;x++)g.normal&&(V[L++]=0,V[L++]=0,V[L++]=1),g.tangent&&(D[P++]=1,D[P++]=0,D[P++]=0),g.bitangent&&(R[k++]=0,R[k++]=1,R[k++]=0)}var Y=12*h-12,Z=d.IndexDatatype.createTypedArray(F,Y),J=0,W=0;for(x=0;x<h-1;x++)Z[J++]=W,Z[J++]=W+2,Z[J++]=W+3,Z[J++]=W,Z[J++]=W+3,Z[J++]=W+1,W+=2;for(Z[J++]=_-2,Z[J++]=0,Z[J++]=1,Z[J++]=_-2,Z[J++]=1,Z[J++]=_-1,x=1;x<h-1;x++)Z[J++]=_+x+1,Z[J++]=_+x,Z[J++]=_;for(x=1;x<h-1;x++)Z[J++]=C,Z[J++]=C+x,Z[J++]=C+x+1;var j=0;if(g.st){var q=Math.max(f,A);for(x=0;x<F;x++){var H=r.Cartesian3.fromArray(w,3*x,v);G[j++]=(H.x+q)/(2*q),G[j++]=(H.y+q)/(2*q)}}var K=new m.GeometryAttributes;g.position&&(K.position=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:w})),g.normal&&(K.normal=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V})),g.tangent&&(K.tangent=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),g.bitangent&&(K.bitangent=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),g.st&&(K.st=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:G})),l.x=.5*s,l.y=Math.max(A,f);var Q=new a.BoundingSphere(r.Cartesian3.ZERO,r.Cartesian2.magnitude(l));if(i.defined(t._offsetAttribute)){s=w.length;var X=new Uint8Array(s/3),$=t._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(X,$),K.applyOffset=new u.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:X})}return new u.Geometry({attributes:K,indices:Z,primitiveType:u.PrimitiveType.TRIANGLES,boundingSphere:Q,offsetAttribute:t._offsetAttribute})}},A.getUnitCylinder=function(){return i.defined(g)||(g=A.createGeometry(new A({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),g},t.CylinderGeometry=A}));
