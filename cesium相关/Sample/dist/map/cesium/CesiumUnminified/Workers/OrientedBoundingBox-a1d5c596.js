define(["exports","./BoundingSphere-2b618cd6","./Cartesian2-cce28994","./Check-edea0f91","./defaultValue-81eec7ed","./EllipsoidTangentPlane-3ee186ca","./Math-29cbc3fa","./Matrix4-da4bb68c","./Plane-d04f021c","./Rectangle-1bad9972"],(function(a,t,e,n,r,i,s,o,C,c){"use strict";function u(a,t){this.center=e.Cartesian3.clone(r.defaultValue(a,e.Cartesian3.ZERO)),this.halfAxes=o.Matrix3.clone(r.defaultValue(t,o.Matrix3.ZERO))}u.packedLength=e.Cartesian3.packedLength+o.Matrix3.packedLength,u.pack=function(a,t,n){return n=r.defaultValue(n,0),e.Cartesian3.pack(a.center,t,n),o.Matrix3.pack(a.halfAxes,t,n+e.Cartesian3.packedLength),t},u.unpack=function(a,t,n){return t=r.defaultValue(t,0),r.defined(n)||(n=new u),e.Cartesian3.unpack(a,t,n.center),o.Matrix3.unpack(a,t+e.Cartesian3.packedLength,n.halfAxes),n};var d=new e.Cartesian3,l=new e.Cartesian3,h=new e.Cartesian3,x=new e.Cartesian3,M=new e.Cartesian3,m=new e.Cartesian3,f=new o.Matrix3,p={unitary:new o.Matrix3,diagonal:new o.Matrix3};u.fromPoints=function(a,t){if(r.defined(t)||(t=new u),!r.defined(a)||0===a.length)return t.halfAxes=o.Matrix3.ZERO,t.center=e.Cartesian3.ZERO,t;var n,i=a.length,s=e.Cartesian3.clone(a[0],d);for(n=1;n<i;n++)e.Cartesian3.add(s,a[n],s);var C=1/i;e.Cartesian3.multiplyByScalar(s,C,s);var c,g=0,w=0,y=0,N=0,b=0,O=0;for(n=0;n<i;n++)g+=(c=e.Cartesian3.subtract(a[n],s,l)).x*c.x,w+=c.x*c.y,y+=c.x*c.z,N+=c.y*c.y,b+=c.y*c.z,O+=c.z*c.z;g*=C,w*=C,y*=C,N*=C,b*=C,O*=C;var v=f;v[0]=g,v[1]=w,v[2]=y,v[3]=w,v[4]=N,v[5]=b,v[6]=y,v[7]=b,v[8]=O;var P=o.Matrix3.computeEigenDecomposition(v,p),T=o.Matrix3.clone(P.unitary,t.halfAxes),A=o.Matrix3.getColumn(T,0,x),I=o.Matrix3.getColumn(T,1,M),R=o.Matrix3.getColumn(T,2,m),E=-Number.MAX_VALUE,S=-Number.MAX_VALUE,U=-Number.MAX_VALUE,L=Number.MAX_VALUE,z=Number.MAX_VALUE,B=Number.MAX_VALUE;for(n=0;n<i;n++)c=a[n],E=Math.max(e.Cartesian3.dot(A,c),E),S=Math.max(e.Cartesian3.dot(I,c),S),U=Math.max(e.Cartesian3.dot(R,c),U),L=Math.min(e.Cartesian3.dot(A,c),L),z=Math.min(e.Cartesian3.dot(I,c),z),B=Math.min(e.Cartesian3.dot(R,c),B);A=e.Cartesian3.multiplyByScalar(A,.5*(L+E),A),I=e.Cartesian3.multiplyByScalar(I,.5*(z+S),I),R=e.Cartesian3.multiplyByScalar(R,.5*(B+U),R);var V=e.Cartesian3.add(A,I,t.center);e.Cartesian3.add(V,R,V);var _=h;return _.x=E-L,_.y=S-z,_.z=U-B,e.Cartesian3.multiplyByScalar(_,.5,_),o.Matrix3.multiplyByScale(t.halfAxes,_,t.halfAxes),t};var g=new e.Cartesian3,w=new e.Cartesian3;function y(a,t,n,i,s,C,c,d,l,h,x){r.defined(x)||(x=new u);var M=x.halfAxes;o.Matrix3.setColumn(M,0,t,M),o.Matrix3.setColumn(M,1,n,M),o.Matrix3.setColumn(M,2,i,M);var m=g;m.x=(s+C)/2,m.y=(c+d)/2,m.z=(l+h)/2;var f=w;f.x=(C-s)/2,f.y=(d-c)/2,f.z=(h-l)/2;var p=x.center;return m=o.Matrix3.multiplyByVector(M,m,m),e.Cartesian3.add(a,m,p),o.Matrix3.multiplyByScale(M,f,M),x}var N=new e.Cartographic,b=new e.Cartesian3,O=new e.Cartographic,v=new e.Cartographic,P=new e.Cartographic,T=new e.Cartographic,A=new e.Cartographic,I=new e.Cartesian3,R=new e.Cartesian3,E=new e.Cartesian3,S=new e.Cartesian3,U=new e.Cartesian3,L=new e.Cartesian2,z=new e.Cartesian2,B=new e.Cartesian2,V=new e.Cartesian2,_=new e.Cartesian2,k=new e.Cartesian3,W=new e.Cartesian3,X=new e.Cartesian3,q=new e.Cartesian3,D=new e.Cartesian2,j=new e.Cartesian3,Z=new e.Cartesian3,Y=new e.Cartesian3,G=new C.Plane(e.Cartesian3.UNIT_X,0);u.fromRectangle=function(a,t,n,o,u){var d,l,h,x,M,m,f;if(t=r.defaultValue(t,0),n=r.defaultValue(n,0),o=r.defaultValue(o,e.Ellipsoid.WGS84),a.width<=s.CesiumMath.PI){var p=c.Rectangle.center(a,N),g=o.cartographicToCartesian(p,b),w=new i.EllipsoidTangentPlane(g,o);f=w.plane;var F=p.longitude,H=a.south<0&&a.north>0?0:p.latitude,J=e.Cartographic.fromRadians(F,a.north,n,O),K=e.Cartographic.fromRadians(a.west,a.north,n,v),Q=e.Cartographic.fromRadians(a.west,H,n,P),$=e.Cartographic.fromRadians(a.west,a.south,n,T),aa=e.Cartographic.fromRadians(F,a.south,n,A),ta=o.cartographicToCartesian(J,I),ea=o.cartographicToCartesian(K,R),na=o.cartographicToCartesian(Q,E),ra=o.cartographicToCartesian($,S),ia=o.cartographicToCartesian(aa,U),sa=w.projectPointToNearestOnPlane(ta,L),oa=w.projectPointToNearestOnPlane(ea,z),Ca=w.projectPointToNearestOnPlane(na,B),ca=w.projectPointToNearestOnPlane(ra,V),ua=w.projectPointToNearestOnPlane(ia,_);return l=-(d=Math.min(oa.x,Ca.x,ca.x)),x=Math.max(oa.y,sa.y),h=Math.min(ca.y,ua.y),K.height=$.height=t,ea=o.cartographicToCartesian(K,R),ra=o.cartographicToCartesian($,S),M=Math.min(C.Plane.getPointDistance(f,ea),C.Plane.getPointDistance(f,ra)),m=n,y(w.origin,w.xAxis,w.yAxis,w.zAxis,d,l,h,x,M,m,u)}var da=a.south>0,la=a.north<0,ha=da?a.south:la?a.north:0,xa=c.Rectangle.center(a,N).longitude,Ma=e.Cartesian3.fromRadians(xa,ha,n,o,k);Ma.z=0;var ma=Math.abs(Ma.x)<s.CesiumMath.EPSILON10&&Math.abs(Ma.y)<s.CesiumMath.EPSILON10?e.Cartesian3.UNIT_X:e.Cartesian3.normalize(Ma,W),fa=e.Cartesian3.UNIT_Z,pa=e.Cartesian3.cross(ma,fa,X);f=C.Plane.fromPointNormal(Ma,ma,G);var ga=e.Cartesian3.fromRadians(xa+s.CesiumMath.PI_OVER_TWO,ha,n,o,q);d=-(l=e.Cartesian3.dot(C.Plane.projectPointOntoPlane(f,ga,D),pa)),x=e.Cartesian3.fromRadians(0,a.north,la?t:n,o,j).z,h=e.Cartesian3.fromRadians(0,a.south,da?t:n,o,Z).z;var wa=e.Cartesian3.fromRadians(a.east,ha,n,o,Y);return y(Ma,pa,fa,ma,d,l,h,x,M=C.Plane.getPointDistance(f,wa),m=0,u)},u.clone=function(a,t){if(r.defined(a))return r.defined(t)?(e.Cartesian3.clone(a.center,t.center),o.Matrix3.clone(a.halfAxes,t.halfAxes),t):new u(a.center,a.halfAxes)},u.intersectPlane=function(a,n){var r=a.center,i=n.normal,s=a.halfAxes,C=i.x,c=i.y,u=i.z,d=Math.abs(C*s[o.Matrix3.COLUMN0ROW0]+c*s[o.Matrix3.COLUMN0ROW1]+u*s[o.Matrix3.COLUMN0ROW2])+Math.abs(C*s[o.Matrix3.COLUMN1ROW0]+c*s[o.Matrix3.COLUMN1ROW1]+u*s[o.Matrix3.COLUMN1ROW2])+Math.abs(C*s[o.Matrix3.COLUMN2ROW0]+c*s[o.Matrix3.COLUMN2ROW1]+u*s[o.Matrix3.COLUMN2ROW2]),l=e.Cartesian3.dot(i,r)+n.distance;return l<=-d?t.Intersect.OUTSIDE:l>=d?t.Intersect.INSIDE:t.Intersect.INTERSECTING};var F=new e.Cartesian3,H=new e.Cartesian3,J=new e.Cartesian3,K=new e.Cartesian3,Q=new e.Cartesian3,$=new e.Cartesian3;u.distanceSquaredTo=function(a,t){var n=e.Cartesian3.subtract(t,a.center,g),r=a.halfAxes,i=o.Matrix3.getColumn(r,0,F),C=o.Matrix3.getColumn(r,1,H),c=o.Matrix3.getColumn(r,2,J),u=e.Cartesian3.magnitude(i),d=e.Cartesian3.magnitude(C),l=e.Cartesian3.magnitude(c),h=!0,x=!0,M=!0;u>0?e.Cartesian3.divideByScalar(i,u,i):h=!1,d>0?e.Cartesian3.divideByScalar(C,d,C):x=!1,l>0?e.Cartesian3.divideByScalar(c,l,c):M=!1;var m,f,p,w=!h+!x+!M;if(1===w){var y=i;m=C,f=c,x?M||(y=c,f=i):(y=C,m=i),p=e.Cartesian3.cross(m,f,Q),y===i?i=p:y===C?C=p:y===c&&(c=p)}else if(2===w){m=i,x?m=C:M&&(m=c);var N=e.Cartesian3.UNIT_Y;N.equalsEpsilon(m,s.CesiumMath.EPSILON3)&&(N=e.Cartesian3.UNIT_X),f=e.Cartesian3.cross(m,N,K),e.Cartesian3.normalize(f,f),p=e.Cartesian3.cross(m,f,Q),e.Cartesian3.normalize(p,p),m===i?(C=f,c=p):m===C?(c=f,i=p):m===c&&(i=f,C=p)}else 3===w&&(i=e.Cartesian3.UNIT_X,C=e.Cartesian3.UNIT_Y,c=e.Cartesian3.UNIT_Z);var b=$;b.x=e.Cartesian3.dot(n,i),b.y=e.Cartesian3.dot(n,C),b.z=e.Cartesian3.dot(n,c);var O,v=0;return b.x<-u?v+=(O=b.x+u)*O:b.x>u&&(v+=(O=b.x-u)*O),b.y<-d?v+=(O=b.y+d)*O:b.y>d&&(v+=(O=b.y-d)*O),b.z<-l?v+=(O=b.z+l)*O:b.z>l&&(v+=(O=b.z-l)*O),v};var aa=new e.Cartesian3,ta=new e.Cartesian3;u.computePlaneDistances=function(a,n,i,s){r.defined(s)||(s=new t.Interval);var C=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=a.center,d=a.halfAxes,l=o.Matrix3.getColumn(d,0,F),h=o.Matrix3.getColumn(d,1,H),x=o.Matrix3.getColumn(d,2,J),M=e.Cartesian3.add(l,h,aa);e.Cartesian3.add(M,x,M),e.Cartesian3.add(M,u,M);var m=e.Cartesian3.subtract(M,n,ta),f=e.Cartesian3.dot(i,m);return C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.add(u,l,M),e.Cartesian3.add(M,h,M),e.Cartesian3.subtract(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.add(u,l,M),e.Cartesian3.subtract(M,h,M),e.Cartesian3.add(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.add(u,l,M),e.Cartesian3.subtract(M,h,M),e.Cartesian3.subtract(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.subtract(u,l,M),e.Cartesian3.add(M,h,M),e.Cartesian3.add(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.subtract(u,l,M),e.Cartesian3.add(M,h,M),e.Cartesian3.subtract(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.subtract(u,l,M),e.Cartesian3.subtract(M,h,M),e.Cartesian3.add(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),e.Cartesian3.subtract(u,l,M),e.Cartesian3.subtract(M,h,M),e.Cartesian3.subtract(M,x,M),e.Cartesian3.subtract(M,n,m),f=e.Cartesian3.dot(i,m),C=Math.min(f,C),c=Math.max(f,c),s.start=C,s.stop=c,s};var ea=new t.BoundingSphere;u.isOccluded=function(a,e){var n=t.BoundingSphere.fromOrientedBoundingBox(a,ea);return!e.isBoundingSphereVisible(n)},u.prototype.intersectPlane=function(a){return u.intersectPlane(this,a)},u.prototype.distanceSquaredTo=function(a){return u.distanceSquaredTo(this,a)},u.prototype.computePlaneDistances=function(a,t,e){return u.computePlaneDistances(this,a,t,e)},u.prototype.isOccluded=function(a){return u.isOccluded(this,a)},u.equals=function(a,t){return a===t||r.defined(a)&&r.defined(t)&&e.Cartesian3.equals(a.center,t.center)&&o.Matrix3.equals(a.halfAxes,t.halfAxes)},u.prototype.clone=function(a){return u.clone(this,a)},u.prototype.equals=function(a){return u.equals(this,a)},a.OrientedBoundingBox=u}));
