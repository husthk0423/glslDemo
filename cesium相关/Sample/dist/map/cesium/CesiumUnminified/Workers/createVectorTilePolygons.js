define(["./AttributeCompression-dc008507","./Cartesian2-cce28994","./Color-f5223c05","./defaultValue-81eec7ed","./IndexDatatype-2503dc5a","./Math-29cbc3fa","./OrientedBoundingBox-a1d5c596","./Rectangle-1bad9972","./createTaskProcessorWorker","./ComponentDatatype-c1201c79","./Check-edea0f91","./WebGLConstants-1c8239cc","./Matrix4-da4bb68c","./RuntimeError-94b0bf5f","./Matrix2-c857e514","./Transforms-599d3866","./when-422ea0ae","./Resource-721e53e7","./combine-0897f2e3","./BoundingSphere-2b618cd6","./GeographicProjection-54ec8d9d","./EllipsoidTangentPlane-3ee186ca","./AxisAlignedBoundingBox-a270696e","./IntersectionTests-878c0e54","./Plane-d04f021c"],(function(e,a,n,r,t,i,o,s,d,c,f,u,h,l,g,p,b,C,m,y,v,I,x,w,A){"use strict";var B=new a.Cartesian3,E=new a.Ellipsoid,N=new s.Rectangle,T={min:void 0,max:void 0,indexBytesPerElement:void 0};function k(e,a,r){var t=a.length,i=2+t*o.OrientedBoundingBox.packedLength+1+function(e){for(var a=e.length,r=0,t=0;t<a;++t)r+=n.Color.packedLength+3+e[t].batchIds.length;return r}(r),s=new Float64Array(i),d=0;s[d++]=e,s[d++]=t;for(var c=0;c<t;++c)o.OrientedBoundingBox.pack(a[c],s,d),d+=o.OrientedBoundingBox.packedLength;var f=r.length;s[d++]=f;for(var u=0;u<f;++u){var h=r[u];n.Color.pack(h.color,s,d),d+=n.Color.packedLength,s[d++]=h.offset,s[d++]=h.count;var l=h.batchIds,g=l.length;s[d++]=g;for(var p=0;p<g;++p)s[d++]=l[p]}return s}var L=new a.Cartesian3,O=new a.Cartesian3,P=new a.Cartesian3,U=new a.Cartesian3,R=new a.Cartesian3,S=new a.Cartographic,F=new s.Rectangle;return d((function(d,c){var f;!function(e){var n=new Float64Array(e),r=0;T.indexBytesPerElement=n[r++],T.min=n[r++],T.max=n[r++],a.Cartesian3.unpack(n,r,B),r+=a.Cartesian3.packedLength,a.Ellipsoid.unpack(n,r,E),r+=a.Ellipsoid.packedLength,s.Rectangle.unpack(n,r,N)}(d.packedBuffer),f=2===T.indexBytesPerElement?new Uint16Array(d.indices):new Uint32Array(d.indices);var u,h,l,g=new Uint16Array(d.positions),p=new Uint32Array(d.counts),b=new Uint32Array(d.indexCounts),C=new Uint32Array(d.batchIds),m=new Uint32Array(d.batchTableColors),y=new Array(p.length),v=B,I=E,x=N,w=T.min,A=T.max,M=d.minimumHeights,D=d.maximumHeights;r.defined(M)&&r.defined(D)&&(M=new Float32Array(M),D=new Float32Array(D));var _=g.length/2,G=g.subarray(0,_),V=g.subarray(_,2*_);e.AttributeCompression.zigZagDeltaDecode(G,V);var Y=new Float64Array(3*_);for(u=0;u<_;++u){var H=G[u],W=V[u],j=i.CesiumMath.lerp(x.west,x.east,H/32767),z=i.CesiumMath.lerp(x.south,x.north,W/32767),Z=a.Cartographic.fromRadians(j,z,0,S),q=I.cartographicToCartesian(Z,L);a.Cartesian3.pack(q,Y,3*u)}var J=p.length,K=new Array(J),Q=new Array(J),X=0,$=0;for(u=0;u<J;++u)K[u]=X,Q[u]=$,X+=p[u],$+=b[u];var ee,ae=new Float32Array(3*_*2),ne=new Uint16Array(2*_),re=new Uint32Array(Q.length),te=new Uint32Array(b.length),ie=[],oe={};for(u=0;u<J;++u)l=m[u],r.defined(oe[l])?(oe[l].positionLength+=p[u],oe[l].indexLength+=b[u],oe[l].batchIds.push(u)):oe[l]={positionLength:p[u],indexLength:b[u],offset:0,indexOffset:0,batchIds:[u]};var se=0,de=0;for(l in oe)if(oe.hasOwnProperty(l)){(ee=oe[l]).offset=se,ee.indexOffset=de;var ce=2*ee.positionLength,fe=2*ee.indexLength+6*ee.positionLength;se+=ce,de+=fe,ee.indexLength=fe}var ue=[];for(l in oe)oe.hasOwnProperty(l)&&(ee=oe[l],ue.push({color:n.Color.fromRgba(parseInt(l)),offset:ee.indexOffset,count:ee.indexLength,batchIds:ee.batchIds}));for(u=0;u<J;++u){var he=(ee=oe[l=m[u]]).offset,le=3*he,ge=he,pe=K[u],be=p[u],Ce=C[u],me=w,ye=A;r.defined(M)&&r.defined(D)&&(me=M[u],ye=D[u]);var ve=Number.POSITIVE_INFINITY,Ie=Number.NEGATIVE_INFINITY,xe=Number.POSITIVE_INFINITY,we=Number.NEGATIVE_INFINITY;for(h=0;h<be;++h){var Ae=a.Cartesian3.unpack(Y,3*pe+3*h,L);I.scaleToGeodeticSurface(Ae,Ae);var Be=I.cartesianToCartographic(Ae,S),Ee=Be.latitude,Ne=Be.longitude;ve=Math.min(Ee,ve),Ie=Math.max(Ee,Ie),xe=Math.min(Ne,xe),we=Math.max(Ne,we);var Te=I.geodeticSurfaceNormal(Ae,O),ke=a.Cartesian3.multiplyByScalar(Te,me,P),Le=a.Cartesian3.add(Ae,ke,U);ke=a.Cartesian3.multiplyByScalar(Te,ye,ke);var Oe=a.Cartesian3.add(Ae,ke,R);a.Cartesian3.subtract(Oe,v,Oe),a.Cartesian3.subtract(Le,v,Le),a.Cartesian3.pack(Oe,ae,le),a.Cartesian3.pack(Le,ae,le+3),ne[ge]=Ce,ne[ge+1]=Ce,le+=6,ge+=2}(x=F).west=xe,x.east=we,x.south=ve,x.north=Ie,y[u]=o.OrientedBoundingBox.fromRectangle(x,w,A,I);var Pe=ee.indexOffset,Ue=Q[u],Re=b[u];for(re[u]=Pe,h=0;h<Re;h+=3){var Se=f[Ue+h]-pe,Fe=f[Ue+h+1]-pe,Me=f[Ue+h+2]-pe;ie[Pe++]=2*Se+he,ie[Pe++]=2*Fe+he,ie[Pe++]=2*Me+he,ie[Pe++]=2*Me+1+he,ie[Pe++]=2*Fe+1+he,ie[Pe++]=2*Se+1+he}for(h=0;h<be;++h){var De=h,_e=(h+1)%be;ie[Pe++]=2*De+1+he,ie[Pe++]=2*_e+he,ie[Pe++]=2*De+he,ie[Pe++]=2*De+1+he,ie[Pe++]=2*_e+1+he,ie[Pe++]=2*_e+he}ee.offset+=2*be,ee.indexOffset=Pe,te[u]=Pe-re[u]}ie=t.IndexDatatype.createTypedArray(ae.length/3,ie);for(var Ge=ue.length,Ve=0;Ve<Ge;++Ve){for(var Ye=ue[Ve].batchIds,He=0,We=Ye.length,je=0;je<We;++je)He+=te[Ye[je]];ue[Ve].count=He}var ze=k(2===ie.BYTES_PER_ELEMENT?t.IndexDatatype.UNSIGNED_SHORT:t.IndexDatatype.UNSIGNED_INT,y,ue);return c.push(ae.buffer,ie.buffer,re.buffer,te.buffer,ne.buffer,ze.buffer),{positions:ae.buffer,indices:ie.buffer,indexOffsets:re.buffer,indexCounts:te.buffer,batchIds:ne.buffer,packedBuffer:ze.buffer}}))}));
