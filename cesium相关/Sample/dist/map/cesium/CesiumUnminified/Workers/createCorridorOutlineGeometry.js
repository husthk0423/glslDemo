define(["./GeometryOffsetAttribute-0a70352a","./arrayRemoveDuplicates-9a47c9b6","./BoundingSphere-2b618cd6","./Cartesian2-cce28994","./Check-edea0f91","./ComponentDatatype-c1201c79","./PolylineVolumeGeometryLibrary-58345cc1","./CorridorGeometryLibrary-aa0eb40d","./defaultValue-81eec7ed","./GeometryAttribute-c4e682f4","./GeometryAttributes-32b29525","./IndexDatatype-2503dc5a","./Math-29cbc3fa","./PolygonPipeline-8ba20582","./GeographicProjection-54ec8d9d","./Matrix4-da4bb68c","./RuntimeError-94b0bf5f","./Rectangle-1bad9972","./WebGLConstants-1c8239cc","./EllipsoidTangentPlane-3ee186ca","./AxisAlignedBoundingBox-a270696e","./IntersectionTests-878c0e54","./Plane-d04f021c","./Transforms-599d3866","./when-422ea0ae","./Resource-721e53e7","./combine-0897f2e3","./PolylinePipeline-f785d88a","./EllipsoidGeodesic-bc3178c0","./EllipsoidRhumbLine-52cdeee5","./Matrix2-c857e514"],(function(e,t,i,r,o,a,n,s,l,d,u,p,f,h,c,y,g,b,m,v,A,_,E,C,G,P,T,w,L,D,x){"use strict";var k=new r.Cartesian3,V=new r.Cartesian3,N=new r.Cartesian3;function O(e,t){var i,o,f,h=[],c=e.positions,y=e.corners,g=e.endPositions,b=new u.GeometryAttributes,m=0,v=0,A=0;for(o=0;o<c.length;o+=2)m+=f=c[o].length-3,A+=f/3*4,v+=c[o+1].length-3;for(m+=3,v+=3,o=0;o<y.length;o++){i=y[o];var _=y[o].leftPositions;l.defined(_)?(m+=f=_.length,A+=f/3*2):(v+=f=y[o].rightPositions.length,A+=f/3*2)}var E,C=l.defined(g);C&&(m+=E=g[0].length-3,v+=E,A+=4*(E/=3));var G,P,T,w,L,D,x=m+v,O=new Float64Array(x),H=0,I=x-1,M=E/2,R=p.IndexDatatype.createTypedArray(x/3,A+4),S=0;if(R[S++]=H/3,R[S++]=(I-2)/3,C){h.push(H/3),D=k,L=V;var B=g[0];for(o=0;o<M;o++)D=r.Cartesian3.fromArray(B,3*(M-1-o),D),L=r.Cartesian3.fromArray(B,3*(M+o),L),s.CorridorGeometryLibrary.addAttribute(O,L,H),s.CorridorGeometryLibrary.addAttribute(O,D,void 0,I),w=(P=H/3)+1,T=(G=(I-2)/3)-1,R[S++]=G,R[S++]=T,R[S++]=P,R[S++]=w,H+=3,I-=3}var U=0,F=c[U++],Y=c[U++];for(O.set(F,H),O.set(Y,I-Y.length+1),f=Y.length-3,h.push(H/3,(I-2)/3),o=0;o<f;o+=3)w=(P=H/3)+1,T=(G=(I-2)/3)-1,R[S++]=G,R[S++]=T,R[S++]=P,R[S++]=w,H+=3,I-=3;for(o=0;o<y.length;o++){var q,W,j=(i=y[o]).leftPositions,J=i.rightPositions,z=N;if(l.defined(j)){for(I-=3,W=T,h.push(w),q=0;q<j.length/3;q++)z=r.Cartesian3.fromArray(j,3*q,z),R[S++]=W-q-1,R[S++]=W-q,s.CorridorGeometryLibrary.addAttribute(O,z,void 0,I),I-=3;h.push(W-Math.floor(j.length/6)),t===n.CornerType.BEVELED&&h.push((I-2)/3+1),H+=3}else{for(H+=3,W=w,h.push(T),q=0;q<J.length/3;q++)z=r.Cartesian3.fromArray(J,3*q,z),R[S++]=W+q,R[S++]=W+q+1,s.CorridorGeometryLibrary.addAttribute(O,z,H),H+=3;h.push(W+Math.floor(J.length/6)),t===n.CornerType.BEVELED&&h.push(H/3-1),I-=3}for(F=c[U++],Y=c[U++],F.splice(0,3),Y.splice(Y.length-3,3),O.set(F,H),O.set(Y,I-Y.length+1),f=Y.length-3,q=0;q<Y.length;q+=3)P=(w=H/3)-1,G=(T=(I-2)/3)+1,R[S++]=G,R[S++]=T,R[S++]=P,R[S++]=w,H+=3,I-=3;H-=3,I+=3,h.push(H/3,(I-2)/3)}if(C){H+=3,I-=3,D=k,L=V;var K=g[1];for(o=0;o<M;o++)D=r.Cartesian3.fromArray(K,3*(E-o-1),D),L=r.Cartesian3.fromArray(K,3*o,L),s.CorridorGeometryLibrary.addAttribute(O,D,void 0,I),s.CorridorGeometryLibrary.addAttribute(O,L,H),P=(w=H/3)-1,G=(T=(I-2)/3)+1,R[S++]=G,R[S++]=T,R[S++]=P,R[S++]=w,H+=3,I-=3;h.push(H/3)}else h.push(H/3,(I-2)/3);return R[S++]=H/3,R[S++]=(I-2)/3,b.position=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:O}),{attributes:b,indices:R,wallIndices:h}}function H(e){var t=(e=l.defaultValue(e,l.defaultValue.EMPTY_OBJECT)).positions,i=e.width,o=l.defaultValue(e.height,0),a=l.defaultValue(e.extrudedHeight,o);this._positions=t,this._ellipsoid=r.Ellipsoid.clone(l.defaultValue(e.ellipsoid,r.Ellipsoid.WGS84)),this._width=i,this._height=Math.max(o,a),this._extrudedHeight=Math.min(o,a),this._cornerType=l.defaultValue(e.cornerType,n.CornerType.ROUNDED),this._granularity=l.defaultValue(e.granularity,f.CesiumMath.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*r.Cartesian3.packedLength+r.Ellipsoid.packedLength+6}H.pack=function(e,t,i){i=l.defaultValue(i,0);var o=e._positions,a=o.length;t[i++]=a;for(var n=0;n<a;++n,i+=r.Cartesian3.packedLength)r.Cartesian3.pack(o[n],t,i);return r.Ellipsoid.pack(e._ellipsoid,t,i),i+=r.Ellipsoid.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=l.defaultValue(e._offsetAttribute,-1),t};var I=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),M={positions:void 0,ellipsoid:I,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};return H.unpack=function(e,t,i){t=l.defaultValue(t,0);for(var o=e[t++],a=new Array(o),n=0;n<o;++n,t+=r.Cartesian3.packedLength)a[n]=r.Cartesian3.unpack(e,t);var s=r.Ellipsoid.unpack(e,t,I);t+=r.Ellipsoid.packedLength;var d=e[t++],u=e[t++],p=e[t++],f=e[t++],h=e[t++],c=e[t];return l.defined(i)?(i._positions=a,i._ellipsoid=r.Ellipsoid.clone(s,i._ellipsoid),i._width=d,i._height=u,i._extrudedHeight=p,i._cornerType=f,i._granularity=h,i._offsetAttribute=-1===c?void 0:c,i):(M.positions=a,M.width=d,M.height=u,M.extrudedHeight=p,M.cornerType=f,M.granularity=h,M.offsetAttribute=-1===c?void 0:c,new H(M))},H.createGeometry=function(o){var n=o._positions,u=o._width,c=o._ellipsoid;n=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(n,c);var y=t.arrayRemoveDuplicates(n,r.Cartesian3.equalsEpsilon);if(!(y.length<2||u<=0)){var g,b=o._height,m=o._extrudedHeight,v=!f.CesiumMath.equalsEpsilon(b,m,0,f.CesiumMath.EPSILON2),A={ellipsoid:c,positions:y,width:u,cornerType:o._cornerType,granularity:o._granularity,saveAttributes:!1};if(v)A.height=b,A.extrudedHeight=m,A.offsetAttribute=o._offsetAttribute,g=function(t){var i=t.ellipsoid,r=O(s.CorridorGeometryLibrary.computePositions(t),t.cornerType),o=r.wallIndices,n=t.height,u=t.extrudedHeight,f=r.attributes,c=r.indices,y=f.position.values,g=y.length,b=new Float64Array(g);b.set(y);var m,v=new Float64Array(2*g);if(y=h.PolygonPipeline.scaleToGeodeticHeight(y,n,i),b=h.PolygonPipeline.scaleToGeodeticHeight(b,u,i),v.set(y),v.set(b,g),f.position.values=v,g/=3,l.defined(t.offsetAttribute)){var A=new Uint8Array(2*g);if(t.offsetAttribute===e.GeometryOffsetAttribute.TOP)A=e.arrayFill(A,1,0,g);else{var _=t.offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;A=e.arrayFill(A,_)}f.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:A})}var E=c.length,C=p.IndexDatatype.createTypedArray(v.length/3,2*(E+o.length));C.set(c);var G,P,T=E;for(m=0;m<E;m+=2){var w=c[m],L=c[m+1];C[T++]=w+g,C[T++]=L+g}for(m=0;m<o.length;m++)P=(G=o[m])+g,C[T++]=G,C[T++]=P;return{attributes:f,indices:C}}(A);else if((g=O(s.CorridorGeometryLibrary.computePositions(A),A.cornerType)).attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(g.attributes.position.values,b,c),l.defined(o._offsetAttribute)){var _=g.attributes.position.values.length,E=new Uint8Array(_/3),C=o._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1;e.arrayFill(E,C),g.attributes.applyOffset=new d.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}var G=g.attributes,P=i.BoundingSphere.fromVertices(G.position.values,void 0,3);return new d.Geometry({attributes:G,indices:g.indices,primitiveType:d.PrimitiveType.LINES,boundingSphere:P,offsetAttribute:o._offsetAttribute})}},function(e,t){return l.defined(t)&&(e=H.unpack(e,t)),e._ellipsoid=r.Ellipsoid.clone(e._ellipsoid),H.createGeometry(e)}}));
