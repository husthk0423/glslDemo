define(["./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./RuntimeError-6122571f","./Rectangle-3285eeb3","./WebGLConstants-4ae0db90","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./IndexDatatype-e3260434","./IntersectionTests-525ff5aa","./Plane-dbdf17bf","./EllipsoidTangentPlane-98a8a37e","./EllipsoidRhumbLine-01c8204c","./PolygonPipeline-db004fe0","./EllipsoidGeodesic-c0017f17","./PolylinePipeline-b34abe5b","./WallGeometryLibrary-847d7530"],(function(e,i,t,a,n,r,o,s,l,d,m,u,p,f,h,c,g,y,v,E,_){"use strict";var b=new a.Cartesian3,C=new a.Cartesian3;function H(i){var n=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).positions,r=i.maximumHeights,o=i.minimumHeights,s=e.defaultValue(i.granularity,t.CesiumMath.RADIANS_PER_DEGREE),l=e.defaultValue(i.ellipsoid,a.Ellipsoid.WGS84);this._positions=n,this._minimumHeights=o,this._maximumHeights=r,this._granularity=s,this._ellipsoid=a.Ellipsoid.clone(l),this._workerName="createWallOutlineGeometry";var d=1+n.length*a.Cartesian3.packedLength+2;e.defined(o)&&(d+=o.length),e.defined(r)&&(d+=r.length),this.packedLength=d+a.Ellipsoid.packedLength+1}H.pack=function(i,t,n){var r;n=e.defaultValue(n,0);var o=i._positions,s=o.length;for(t[n++]=s,r=0;r<s;++r,n+=a.Cartesian3.packedLength)a.Cartesian3.pack(o[r],t,n);var l=i._minimumHeights;if(s=e.defined(l)?l.length:0,t[n++]=s,e.defined(l))for(r=0;r<s;++r)t[n++]=l[r];var d=i._maximumHeights;if(s=e.defined(d)?d.length:0,t[n++]=s,e.defined(d))for(r=0;r<s;++r)t[n++]=d[r];return a.Ellipsoid.pack(i._ellipsoid,t,n),t[n+=a.Ellipsoid.packedLength]=i._granularity,t};var A=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),k={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:A,granularity:void 0};return H.unpack=function(i,t,n){var r;t=e.defaultValue(t,0);var o,s,l=i[t++],d=new Array(l);for(r=0;r<l;++r,t+=a.Cartesian3.packedLength)d[r]=a.Cartesian3.unpack(i,t);if((l=i[t++])>0)for(o=new Array(l),r=0;r<l;++r)o[r]=i[t++];if((l=i[t++])>0)for(s=new Array(l),r=0;r<l;++r)s[r]=i[t++];var m=a.Ellipsoid.unpack(i,t,A),u=i[t+=a.Ellipsoid.packedLength];return e.defined(n)?(n._positions=d,n._minimumHeights=o,n._maximumHeights=s,n._ellipsoid=a.Ellipsoid.clone(m,n._ellipsoid),n._granularity=u,n):(k.positions=d,k.minimumHeights=o,k.maximumHeights=s,k.granularity=u,new H(k))},H.fromConstantHeights=function(i){var t,a,n=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).positions,r=i.minimumHeight,o=i.maximumHeight,s=e.defined(r),l=e.defined(o);if(s||l){var d=n.length;t=s?new Array(d):void 0,a=l?new Array(d):void 0;for(var m=0;m<d;++m)s&&(t[m]=r),l&&(a[m]=o)}return new H({positions:n,maximumHeights:a,minimumHeights:t,ellipsoid:i.ellipsoid})},H.createGeometry=function(i){var r=i._positions,o=i._minimumHeights,s=i._maximumHeights,l=i._granularity,f=i._ellipsoid,h=_.WallGeometryLibrary.computePositions(f,r,s,o,l,!1);if(e.defined(h)){var c,g=h.bottomPositions,y=h.topPositions,v=y.length,E=2*v,H=new Float64Array(E),A=0;for(v/=3,c=0;c<v;++c){var k=3*c,w=a.Cartesian3.fromArray(y,k,b),P=a.Cartesian3.fromArray(g,k,C);H[A++]=P.x,H[A++]=P.y,H[A++]=P.z,H[A++]=w.x,H[A++]=w.y,H[A++]=w.z}var G=new u.GeometryAttributes({position:new m.GeometryAttribute({componentDatatype:d.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:H})}),L=E/3;E=2*L-4+L;var x=p.IndexDatatype.createTypedArray(L,E),T=0;for(c=0;c<L-2;c+=2){var V=c,D=c+2,S=a.Cartesian3.fromArray(H,3*V,b),I=a.Cartesian3.fromArray(H,3*D,C);if(!a.Cartesian3.equalsEpsilon(S,I,t.CesiumMath.EPSILON10)){var R=c+1,B=c+3;x[T++]=R,x[T++]=V,x[T++]=R,x[T++]=B,x[T++]=V,x[T++]=D}}return x[T++]=L-2,x[T++]=L-1,new m.Geometry({attributes:G,indices:x,primitiveType:m.PrimitiveType.LINES,boundingSphere:new n.BoundingSphere.fromVertices(H)})}},function(i,t){return e.defined(t)&&(i=H.unpack(i,t)),i._ellipsoid=a.Ellipsoid.clone(i._ellipsoid),H.createGeometry(i)}}));
