define(["./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./RuntimeError-6122571f","./Rectangle-3285eeb3","./WebGLConstants-4ae0db90","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryInstance-b1e4a9ef","./Color-73b261ab"],(function(t,e,s,i,n,o,r,a,h,p,u,l,c){"use strict";return class{constructor(t){this.positions=null,this.normals=null,this.sts=null,this.indices=null,this.geometrys=t.positions,this.color=t.color,this.u_tcolor=t.u_tcolor||c.Color.YELLOW,this.height=t.height||500,this.speed=t.speed||600,this.direction=t.direction||-1,this.translucent=t.translucent||!1,this.type=t.type||1}createGeometryInstances(){let t=[];for(let e=0;e<this.geometrys.length;e++){let s=this.geometrys[e],i=this.computePositions_dws(s,this.height);this.positions=i.pos,this.normals=i.normals,this.sts=i.sts,this.indices=i.indices;let n=this.createGeometry(this.positions,this.normals,this.sts,this.indices),o=new l.GeometryInstance({id:Math.random(),geometry:n});t.push(o)}return t}createGeometry(t,e,s,i){let o=new Float64Array(t),r=new Float32Array(e),a=new Float32Array(s),h=new Uint16Array(i);return new u.Geometry({attributes:{position:new u.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:o}),normal:new u.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:r}),st:new u.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:a})},indices:h,primitiveType:u.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromVertices(o)})}computePositions_dws(t,e){let s=t.length,i=[];for(let s in t)i.push(this.addHeight(t[s],e));let n=[],o=[],r=[],a=[];for(let e=0;e<s-1;e++){let s=e+1;n.push(t[e].x,t[e].y,t[e].z),n.push(t[s].x,t[s].y,t[s].z),n.push(i[s].x,i[s].y,i[s].z),n.push(i[e].x,i[e].y,i[e].z),a.push(0,0,1),a.push(0,0,1),a.push(0,0,1),a.push(0,0,1),o.push(0,0,1,0,1,1,0,1);let h=4*e,p=h+1,u=h+2,l=h+3;r.push(h,p,u,u,l,h)}return{pos:n,normals:a,sts:o,indices:r}}addHeight(t,e){let s=e||0;if(t.hasOwnProperty("height"))return t.height+=s,t;{let e=i.Cartographic.fromCartesian(t);return e.height+=s,i.Cartographic.toCartesian(e)}}}}));
