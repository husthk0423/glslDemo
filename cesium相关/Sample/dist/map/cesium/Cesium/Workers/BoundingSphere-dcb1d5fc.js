define(["exports","./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./Transforms-8b7e0d39","./Rectangle-3285eeb3"],(function(e,a,n,r,t,i,s){"use strict";function u(e){this._ellipsoid=a.defaultValue(e,t.Ellipsoid.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(u.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),u.prototype.project=function(e,n){var r=this._semimajorAxis,i=e.longitude*r,s=e.latitude*r,u=e.height;return a.defined(n)?(n.x=i,n.y=s,n.z=u,n):new t.Cartesian3(i,s,u)},u.prototype.unproject=function(e,n){var r=this._oneOverSemimajorAxis,i=e.x*r,s=e.y*r,u=e.z;return a.defined(n)?(n.longitude=i,n.latitude=s,n.height=u,n):new t.Cartographic(i,s,u)};var c=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function d(e,n){this.start=a.defaultValue(e,0),this.stop=a.defaultValue(n,0)}function o(e,n){this.center=t.Cartesian3.clone(a.defaultValue(e,t.Cartesian3.ZERO)),this.radius=a.defaultValue(n,0)}var C=new t.Cartesian3,l=new t.Cartesian3,f=new t.Cartesian3,m=new t.Cartesian3,v=new t.Cartesian3,y=new t.Cartesian3,x=new t.Cartesian3,g=new t.Cartesian3,h=new t.Cartesian3,p=new t.Cartesian3,z=new t.Cartesian3,w=new t.Cartesian3,S=4/3*r.CesiumMath.PI;o.fromPoints=function(e,n){if(a.defined(n)||(n=new o),!a.defined(e)||0===e.length)return n.center=t.Cartesian3.clone(t.Cartesian3.ZERO,n.center),n.radius=0,n;var r,i=t.Cartesian3.clone(e[0],x),s=t.Cartesian3.clone(i,C),u=t.Cartesian3.clone(i,l),c=t.Cartesian3.clone(i,f),d=t.Cartesian3.clone(i,m),S=t.Cartesian3.clone(i,v),q=t.Cartesian3.clone(i,y),b=e.length;for(r=1;r<b;r++){t.Cartesian3.clone(e[r],i);var E=i.x,R=i.y,O=i.z;E<s.x&&t.Cartesian3.clone(i,s),E>d.x&&t.Cartesian3.clone(i,d),R<u.y&&t.Cartesian3.clone(i,u),R>S.y&&t.Cartesian3.clone(i,S),O<c.z&&t.Cartesian3.clone(i,c),O>q.z&&t.Cartesian3.clone(i,q)}var M=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(d,s,g)),P=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(S,u,g)),V=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(q,c,g)),I=s,j=d,T=M;P>T&&(T=P,I=u,j=S),V>T&&(T=V,I=c,j=q);var D=h;D.x=.5*(I.x+j.x),D.y=.5*(I.y+j.y),D.z=.5*(I.z+j.z);var B=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(j,D,g)),Z=Math.sqrt(B),_=p;_.x=s.x,_.y=u.y,_.z=c.z;var N=z;N.x=d.x,N.y=S.y,N.z=q.z;var A=t.Cartesian3.midpoint(_,N,w),G=0;for(r=0;r<b;r++){t.Cartesian3.clone(e[r],i);var W=t.Cartesian3.magnitude(t.Cartesian3.subtract(i,A,g));W>G&&(G=W);var k=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(i,D,g));if(k>B){var U=Math.sqrt(k);B=(Z=.5*(Z+U))*Z;var H=U-Z;D.x=(Z*D.x+H*i.x)/U,D.y=(Z*D.y+H*i.y)/U,D.z=(Z*D.z+H*i.z)/U}}return Z<G?(t.Cartesian3.clone(D,n.center),n.radius=Z):(t.Cartesian3.clone(A,n.center),n.radius=G),n};var q=new u,b=new t.Cartesian3,E=new t.Cartesian3,R=new t.Cartographic,O=new t.Cartographic;o.fromRectangle2D=function(e,a,n){return o.fromRectangleWithHeights2D(e,a,0,0,n)},o.fromRectangleWithHeights2D=function(e,n,r,i,u){if(a.defined(u)||(u=new o),!a.defined(e))return u.center=t.Cartesian3.clone(t.Cartesian3.ZERO,u.center),u.radius=0,u;n=a.defaultValue(n,q),s.Rectangle.southwest(e,R),R.height=r,s.Rectangle.northeast(e,O),O.height=i;var c=n.project(R,b),d=n.project(O,E),C=d.x-c.x,l=d.y-c.y,f=d.z-c.z;u.radius=.5*Math.sqrt(C*C+l*l+f*f);var m=u.center;return m.x=c.x+.5*C,m.y=c.y+.5*l,m.z=c.z+.5*f,u};var M=[];o.fromRectangle3D=function(e,n,r,i){if(n=a.defaultValue(n,t.Ellipsoid.WGS84),r=a.defaultValue(r,0),a.defined(i)||(i=new o),!a.defined(e))return i.center=t.Cartesian3.clone(t.Cartesian3.ZERO,i.center),i.radius=0,i;var u=s.Rectangle.subsample(e,n,r,M);return o.fromPoints(u,i)},o.fromVertices=function(e,n,r,i){if(a.defined(i)||(i=new o),!a.defined(e)||0===e.length)return i.center=t.Cartesian3.clone(t.Cartesian3.ZERO,i.center),i.radius=0,i;n=a.defaultValue(n,t.Cartesian3.ZERO),r=a.defaultValue(r,3);var s=x;s.x=e[0]+n.x,s.y=e[1]+n.y,s.z=e[2]+n.z;var u,c=t.Cartesian3.clone(s,C),d=t.Cartesian3.clone(s,l),S=t.Cartesian3.clone(s,f),q=t.Cartesian3.clone(s,m),b=t.Cartesian3.clone(s,v),E=t.Cartesian3.clone(s,y),R=e.length;for(u=0;u<R;u+=r){var O=e[u]+n.x,M=e[u+1]+n.y,P=e[u+2]+n.z;s.x=O,s.y=M,s.z=P,O<c.x&&t.Cartesian3.clone(s,c),O>q.x&&t.Cartesian3.clone(s,q),M<d.y&&t.Cartesian3.clone(s,d),M>b.y&&t.Cartesian3.clone(s,b),P<S.z&&t.Cartesian3.clone(s,S),P>E.z&&t.Cartesian3.clone(s,E)}var V=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(q,c,g)),I=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(b,d,g)),j=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(E,S,g)),T=c,D=q,B=V;I>B&&(B=I,T=d,D=b),j>B&&(B=j,T=S,D=E);var Z=h;Z.x=.5*(T.x+D.x),Z.y=.5*(T.y+D.y),Z.z=.5*(T.z+D.z);var _=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(D,Z,g)),N=Math.sqrt(_),A=p;A.x=c.x,A.y=d.y,A.z=S.z;var G=z;G.x=q.x,G.y=b.y,G.z=E.z;var W=t.Cartesian3.midpoint(A,G,w),k=0;for(u=0;u<R;u+=r){s.x=e[u]+n.x,s.y=e[u+1]+n.y,s.z=e[u+2]+n.z;var U=t.Cartesian3.magnitude(t.Cartesian3.subtract(s,W,g));U>k&&(k=U);var H=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(s,Z,g));if(H>_){var L=Math.sqrt(H);_=(N=.5*(N+L))*N;var X=L-N;Z.x=(N*Z.x+X*s.x)/L,Z.y=(N*Z.y+X*s.y)/L,Z.z=(N*Z.z+X*s.z)/L}}return N<k?(t.Cartesian3.clone(Z,i.center),i.radius=N):(t.Cartesian3.clone(W,i.center),i.radius=k),i},o.fromEncodedCartesianVertices=function(e,n,r){if(a.defined(r)||(r=new o),!a.defined(e)||!a.defined(n)||e.length!==n.length||0===e.length)return r.center=t.Cartesian3.clone(t.Cartesian3.ZERO,r.center),r.radius=0,r;var i=x;i.x=e[0]+n[0],i.y=e[1]+n[1],i.z=e[2]+n[2];var s,u=t.Cartesian3.clone(i,C),c=t.Cartesian3.clone(i,l),d=t.Cartesian3.clone(i,f),S=t.Cartesian3.clone(i,m),q=t.Cartesian3.clone(i,v),b=t.Cartesian3.clone(i,y),E=e.length;for(s=0;s<E;s+=3){var R=e[s]+n[s],O=e[s+1]+n[s+1],M=e[s+2]+n[s+2];i.x=R,i.y=O,i.z=M,R<u.x&&t.Cartesian3.clone(i,u),R>S.x&&t.Cartesian3.clone(i,S),O<c.y&&t.Cartesian3.clone(i,c),O>q.y&&t.Cartesian3.clone(i,q),M<d.z&&t.Cartesian3.clone(i,d),M>b.z&&t.Cartesian3.clone(i,b)}var P=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(S,u,g)),V=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(q,c,g)),I=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(b,d,g)),j=u,T=S,D=P;V>D&&(D=V,j=c,T=q),I>D&&(D=I,j=d,T=b);var B=h;B.x=.5*(j.x+T.x),B.y=.5*(j.y+T.y),B.z=.5*(j.z+T.z);var Z=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(T,B,g)),_=Math.sqrt(Z),N=p;N.x=u.x,N.y=c.y,N.z=d.z;var A=z;A.x=S.x,A.y=q.y,A.z=b.z;var G=t.Cartesian3.midpoint(N,A,w),W=0;for(s=0;s<E;s+=3){i.x=e[s]+n[s],i.y=e[s+1]+n[s+1],i.z=e[s+2]+n[s+2];var k=t.Cartesian3.magnitude(t.Cartesian3.subtract(i,G,g));k>W&&(W=k);var U=t.Cartesian3.magnitudeSquared(t.Cartesian3.subtract(i,B,g));if(U>Z){var H=Math.sqrt(U);Z=(_=.5*(_+H))*_;var L=H-_;B.x=(_*B.x+L*i.x)/H,B.y=(_*B.y+L*i.y)/H,B.z=(_*B.z+L*i.z)/H}}return _<W?(t.Cartesian3.clone(B,r.center),r.radius=_):(t.Cartesian3.clone(G,r.center),r.radius=W),r},o.fromCornerPoints=function(e,n,r){a.defined(r)||(r=new o);var i=t.Cartesian3.midpoint(e,n,r.center);return r.radius=t.Cartesian3.distance(i,n),r},o.fromEllipsoid=function(e,n){return a.defined(n)||(n=new o),t.Cartesian3.clone(t.Cartesian3.ZERO,n.center),n.radius=e.maximumRadius,n};var P=new t.Cartesian3;o.fromBoundingSpheres=function(e,n){if(a.defined(n)||(n=new o),!a.defined(e)||0===e.length)return n.center=t.Cartesian3.clone(t.Cartesian3.ZERO,n.center),n.radius=0,n;var r=e.length;if(1===r)return o.clone(e[0],n);if(2===r)return o.union(e[0],e[1],n);var i,s=[];for(i=0;i<r;i++)s.push(e[i].center);var u=(n=o.fromPoints(s,n)).center,c=n.radius;for(i=0;i<r;i++){var d=e[i];c=Math.max(c,t.Cartesian3.distance(u,d.center,P)+d.radius)}return n.radius=c,n};var V=new t.Cartesian3,I=new t.Cartesian3,j=new t.Cartesian3;o.fromOrientedBoundingBox=function(e,n){a.defined(n)||(n=new o);var r=e.halfAxes,s=i.Matrix3.getColumn(r,0,V),u=i.Matrix3.getColumn(r,1,I),c=i.Matrix3.getColumn(r,2,j);return t.Cartesian3.add(s,u,s),t.Cartesian3.add(s,c,s),n.center=t.Cartesian3.clone(e.center,n.center),n.radius=t.Cartesian3.magnitude(s),n},o.clone=function(e,n){if(a.defined(e))return a.defined(n)?(n.center=t.Cartesian3.clone(e.center,n.center),n.radius=e.radius,n):new o(e.center,e.radius)},o.packedLength=4,o.pack=function(e,n,r){r=a.defaultValue(r,0);var t=e.center;return n[r++]=t.x,n[r++]=t.y,n[r++]=t.z,n[r]=e.radius,n},o.unpack=function(e,n,r){n=a.defaultValue(n,0),a.defined(r)||(r=new o);var t=r.center;return t.x=e[n++],t.y=e[n++],t.z=e[n++],r.radius=e[n],r};var T=new t.Cartesian3,D=new t.Cartesian3;o.union=function(e,n,r){a.defined(r)||(r=new o);var i=e.center,s=e.radius,u=n.center,c=n.radius,d=t.Cartesian3.subtract(u,i,T),C=t.Cartesian3.magnitude(d);if(s>=C+c)return e.clone(r),r;if(c>=C+s)return n.clone(r),r;var l=.5*(s+C+c),f=t.Cartesian3.multiplyByScalar(d,(-s+l)/C,D);return t.Cartesian3.add(f,i,f),t.Cartesian3.clone(f,r.center),r.radius=l,r};var B=new t.Cartesian3;o.expand=function(e,a,n){n=o.clone(e,n);var r=t.Cartesian3.magnitude(t.Cartesian3.subtract(a,n.center,B));return r>n.radius&&(n.radius=r),n},o.intersectPlane=function(e,a){var n=e.center,r=e.radius,i=a.normal,s=t.Cartesian3.dot(i,n)+a.distance;return s<-r?c.OUTSIDE:s<r?c.INTERSECTING:c.INSIDE},o.transform=function(e,n,r){return a.defined(r)||(r=new o),r.center=i.Matrix4.multiplyByPoint(n,e.center,r.center),r.radius=i.Matrix4.getMaximumScale(n)*e.radius,r};var Z=new t.Cartesian3;o.distanceSquaredTo=function(e,a){var n=t.Cartesian3.subtract(e.center,a,Z);return t.Cartesian3.magnitudeSquared(n)-e.radius*e.radius},o.transformWithoutScale=function(e,n,r){return a.defined(r)||(r=new o),r.center=i.Matrix4.multiplyByPoint(n,e.center,r.center),r.radius=e.radius,r};var _=new t.Cartesian3;o.computePlaneDistances=function(e,n,r,i){a.defined(i)||(i=new d);var s=t.Cartesian3.subtract(e.center,n,_),u=t.Cartesian3.dot(r,s);return i.start=u-e.radius,i.stop=u+e.radius,i};for(var N=new t.Cartesian3,A=new t.Cartesian3,G=new t.Cartesian3,W=new t.Cartesian3,k=new t.Cartesian3,U=new t.Cartographic,H=new Array(8),L=0;L<8;++L)H[L]=new t.Cartesian3;var X=new u;o.projectTo2D=function(e,n,r){var i,s=(n=a.defaultValue(n,X)).ellipsoid,u=e.center,c=e.radius;i=t.Cartesian3.equals(u,t.Cartesian3.ZERO)?t.Cartesian3.clone(t.Cartesian3.UNIT_X,N):s.geodeticSurfaceNormal(u,N);var d=t.Cartesian3.cross(t.Cartesian3.UNIT_Z,i,A);t.Cartesian3.normalize(d,d);var C=t.Cartesian3.cross(i,d,G);t.Cartesian3.normalize(C,C),t.Cartesian3.multiplyByScalar(i,c,i),t.Cartesian3.multiplyByScalar(C,c,C),t.Cartesian3.multiplyByScalar(d,c,d);var l=t.Cartesian3.negate(C,k),f=t.Cartesian3.negate(d,W),m=H,v=m[0];t.Cartesian3.add(i,C,v),t.Cartesian3.add(v,d,v),v=m[1],t.Cartesian3.add(i,C,v),t.Cartesian3.add(v,f,v),v=m[2],t.Cartesian3.add(i,l,v),t.Cartesian3.add(v,f,v),v=m[3],t.Cartesian3.add(i,l,v),t.Cartesian3.add(v,d,v),t.Cartesian3.negate(i,i),v=m[4],t.Cartesian3.add(i,C,v),t.Cartesian3.add(v,d,v),v=m[5],t.Cartesian3.add(i,C,v),t.Cartesian3.add(v,f,v),v=m[6],t.Cartesian3.add(i,l,v),t.Cartesian3.add(v,f,v),v=m[7],t.Cartesian3.add(i,l,v),t.Cartesian3.add(v,d,v);for(var y=m.length,x=0;x<y;++x){var g=m[x];t.Cartesian3.add(u,g,g);var h=s.cartesianToCartographic(g,U);n.project(h,g)}var p=(u=(r=o.fromPoints(m,r)).center).x,z=u.y,w=u.z;return u.x=w,u.y=p,u.z=z,r},o.isOccluded=function(e,a){return!a.isBoundingSphereVisible(e)},o.equals=function(e,n){return e===n||a.defined(e)&&a.defined(n)&&t.Cartesian3.equals(e.center,n.center)&&e.radius===n.radius},o.prototype.intersectPlane=function(e){return o.intersectPlane(this,e)},o.prototype.distanceSquaredTo=function(e){return o.distanceSquaredTo(this,e)},o.prototype.computePlaneDistances=function(e,a,n){return o.computePlaneDistances(this,e,a,n)},o.prototype.isOccluded=function(e){return o.isOccluded(this,e)},o.prototype.equals=function(e){return o.equals(this,e)},o.prototype.clone=function(e){return o.clone(this,e)},o.prototype.volume=function(){var e=this.radius;return S*e*e*e},e.BoundingSphere=o,e.GeographicProjection=u,e.Intersect=c,e.Interval=d}));
