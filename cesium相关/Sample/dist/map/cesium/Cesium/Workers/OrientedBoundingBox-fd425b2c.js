define(["exports","./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./Rectangle-3285eeb3","./Plane-dbdf17bf","./EllipsoidTangentPlane-98a8a37e"],(function(a,t,e,n,r,i,s,o,C,c){"use strict";function u(a,e){this.center=r.Cartesian3.clone(t.defaultValue(a,r.Cartesian3.ZERO)),this.halfAxes=s.Matrix3.clone(t.defaultValue(e,s.Matrix3.ZERO))}u.packedLength=r.Cartesian3.packedLength+s.Matrix3.packedLength,u.pack=function(a,e,n){return n=t.defaultValue(n,0),r.Cartesian3.pack(a.center,e,n),s.Matrix3.pack(a.halfAxes,e,n+r.Cartesian3.packedLength),e},u.unpack=function(a,e,n){return e=t.defaultValue(e,0),t.defined(n)||(n=new u),r.Cartesian3.unpack(a,e,n.center),s.Matrix3.unpack(a,e+r.Cartesian3.packedLength,n.halfAxes),n};var d=new r.Cartesian3,l=new r.Cartesian3,h=new r.Cartesian3,x=new r.Cartesian3,M=new r.Cartesian3,m=new r.Cartesian3,f=new s.Matrix3,p={unitary:new s.Matrix3,diagonal:new s.Matrix3};u.fromPoints=function(a,e){if(t.defined(e)||(e=new u),!t.defined(a)||0===a.length)return e.halfAxes=s.Matrix3.ZERO,e.center=r.Cartesian3.ZERO,e;var n,i=a.length,o=r.Cartesian3.clone(a[0],d);for(n=1;n<i;n++)r.Cartesian3.add(o,a[n],o);var C=1/i;r.Cartesian3.multiplyByScalar(o,C,o);var c,g=0,w=0,y=0,b=0,O=0,P=0;for(n=0;n<i;n++)g+=(c=r.Cartesian3.subtract(a[n],o,l)).x*c.x,w+=c.x*c.y,y+=c.x*c.z,b+=c.y*c.y,O+=c.y*c.z,P+=c.z*c.z;g*=C,w*=C,y*=C,b*=C,O*=C,P*=C;var N=f;N[0]=g,N[1]=w,N[2]=y,N[3]=w,N[4]=b,N[5]=O,N[6]=y,N[7]=O,N[8]=P;var v=s.Matrix3.computeEigenDecomposition(N,p),A=s.Matrix3.clone(v.unitary,e.halfAxes),T=s.Matrix3.getColumn(A,0,x),R=s.Matrix3.getColumn(A,1,M),I=s.Matrix3.getColumn(A,2,m),E=-Number.MAX_VALUE,L=-Number.MAX_VALUE,z=-Number.MAX_VALUE,S=Number.MAX_VALUE,U=Number.MAX_VALUE,V=Number.MAX_VALUE;for(n=0;n<i;n++)c=a[n],E=Math.max(r.Cartesian3.dot(T,c),E),L=Math.max(r.Cartesian3.dot(R,c),L),z=Math.max(r.Cartesian3.dot(I,c),z),S=Math.min(r.Cartesian3.dot(T,c),S),U=Math.min(r.Cartesian3.dot(R,c),U),V=Math.min(r.Cartesian3.dot(I,c),V);T=r.Cartesian3.multiplyByScalar(T,.5*(S+E),T),R=r.Cartesian3.multiplyByScalar(R,.5*(U+L),R),I=r.Cartesian3.multiplyByScalar(I,.5*(V+z),I);var B=r.Cartesian3.add(T,R,e.center);r.Cartesian3.add(B,I,B);var _=h;return _.x=E-S,_.y=L-U,_.z=z-V,r.Cartesian3.multiplyByScalar(_,.5,_),s.Matrix3.multiplyByScale(e.halfAxes,_,e.halfAxes),e};var g=new r.Cartesian3,w=new r.Cartesian3;function y(a,e,n,i,o,C,c,d,l,h,x){t.defined(x)||(x=new u);var M=x.halfAxes;s.Matrix3.setColumn(M,0,e,M),s.Matrix3.setColumn(M,1,n,M),s.Matrix3.setColumn(M,2,i,M);var m=g;m.x=(o+C)/2,m.y=(c+d)/2,m.z=(l+h)/2;var f=w;f.x=(C-o)/2,f.y=(d-c)/2,f.z=(h-l)/2;var p=x.center;return m=s.Matrix3.multiplyByVector(M,m,m),r.Cartesian3.add(a,m,p),s.Matrix3.multiplyByScale(M,f,M),x}var b=new r.Cartographic,O=new r.Cartesian3,P=new r.Cartographic,N=new r.Cartographic,v=new r.Cartographic,A=new r.Cartographic,T=new r.Cartographic,R=new r.Cartesian3,I=new r.Cartesian3,E=new r.Cartesian3,L=new r.Cartesian3,z=new r.Cartesian3,S=new r.Cartesian2,U=new r.Cartesian2,V=new r.Cartesian2,B=new r.Cartesian2,_=new r.Cartesian2,k=new r.Cartesian3,W=new r.Cartesian3,D=new r.Cartesian3,q=new r.Cartesian3,X=new r.Cartesian2,j=new r.Cartesian3,Z=new r.Cartesian3,G=new r.Cartesian3,F=new C.Plane(r.Cartesian3.UNIT_X,0);u.fromRectangle=function(a,e,i,s,u){var d,l,h,x,M,m,f;if(e=t.defaultValue(e,0),i=t.defaultValue(i,0),s=t.defaultValue(s,r.Ellipsoid.WGS84),a.width<=n.CesiumMath.PI){var p=o.Rectangle.center(a,b),g=s.cartographicToCartesian(p,O),w=new c.EllipsoidTangentPlane(g,s);f=w.plane;var Y=p.longitude,H=a.south<0&&a.north>0?0:p.latitude,J=r.Cartographic.fromRadians(Y,a.north,i,P),K=r.Cartographic.fromRadians(a.west,a.north,i,N),Q=r.Cartographic.fromRadians(a.west,H,i,v),$=r.Cartographic.fromRadians(a.west,a.south,i,A),aa=r.Cartographic.fromRadians(Y,a.south,i,T),ta=s.cartographicToCartesian(J,R),ea=s.cartographicToCartesian(K,I),na=s.cartographicToCartesian(Q,E),ra=s.cartographicToCartesian($,L),ia=s.cartographicToCartesian(aa,z),sa=w.projectPointToNearestOnPlane(ta,S),oa=w.projectPointToNearestOnPlane(ea,U),Ca=w.projectPointToNearestOnPlane(na,V),ca=w.projectPointToNearestOnPlane(ra,B),ua=w.projectPointToNearestOnPlane(ia,_);return l=-(d=Math.min(oa.x,Ca.x,ca.x)),x=Math.max(oa.y,sa.y),h=Math.min(ca.y,ua.y),K.height=$.height=e,ea=s.cartographicToCartesian(K,I),ra=s.cartographicToCartesian($,L),M=Math.min(C.Plane.getPointDistance(f,ea),C.Plane.getPointDistance(f,ra)),m=i,y(w.origin,w.xAxis,w.yAxis,w.zAxis,d,l,h,x,M,m,u)}var da=a.south>0,la=a.north<0,ha=da?a.south:la?a.north:0,xa=o.Rectangle.center(a,b).longitude,Ma=r.Cartesian3.fromRadians(xa,ha,i,s,k);Ma.z=0;var ma=Math.abs(Ma.x)<n.CesiumMath.EPSILON10&&Math.abs(Ma.y)<n.CesiumMath.EPSILON10?r.Cartesian3.UNIT_X:r.Cartesian3.normalize(Ma,W),fa=r.Cartesian3.UNIT_Z,pa=r.Cartesian3.cross(ma,fa,D);f=C.Plane.fromPointNormal(Ma,ma,F);var ga=r.Cartesian3.fromRadians(xa+n.CesiumMath.PI_OVER_TWO,ha,i,s,q);d=-(l=r.Cartesian3.dot(C.Plane.projectPointOntoPlane(f,ga,X),pa)),x=r.Cartesian3.fromRadians(0,a.north,la?e:i,s,j).z,h=r.Cartesian3.fromRadians(0,a.south,da?e:i,s,Z).z;var wa=r.Cartesian3.fromRadians(a.east,ha,i,s,G);return y(Ma,pa,fa,ma,d,l,h,x,M=C.Plane.getPointDistance(f,wa),m=0,u)},u.clone=function(a,e){if(t.defined(a))return t.defined(e)?(r.Cartesian3.clone(a.center,e.center),s.Matrix3.clone(a.halfAxes,e.halfAxes),e):new u(a.center,a.halfAxes)},u.intersectPlane=function(a,t){var e=a.center,n=t.normal,o=a.halfAxes,C=n.x,c=n.y,u=n.z,d=Math.abs(C*o[s.Matrix3.COLUMN0ROW0]+c*o[s.Matrix3.COLUMN0ROW1]+u*o[s.Matrix3.COLUMN0ROW2])+Math.abs(C*o[s.Matrix3.COLUMN1ROW0]+c*o[s.Matrix3.COLUMN1ROW1]+u*o[s.Matrix3.COLUMN1ROW2])+Math.abs(C*o[s.Matrix3.COLUMN2ROW0]+c*o[s.Matrix3.COLUMN2ROW1]+u*o[s.Matrix3.COLUMN2ROW2]),l=r.Cartesian3.dot(n,e)+t.distance;return l<=-d?i.Intersect.OUTSIDE:l>=d?i.Intersect.INSIDE:i.Intersect.INTERSECTING};var Y=new r.Cartesian3,H=new r.Cartesian3,J=new r.Cartesian3,K=new r.Cartesian3;u.distanceSquaredTo=function(a,t){var e=r.Cartesian3.subtract(t,a.center,g),n=a.halfAxes,i=s.Matrix3.getColumn(n,0,Y),o=s.Matrix3.getColumn(n,1,H),C=s.Matrix3.getColumn(n,2,J),c=r.Cartesian3.magnitude(i),u=r.Cartesian3.magnitude(o),d=r.Cartesian3.magnitude(C);r.Cartesian3.normalize(i,i),r.Cartesian3.normalize(o,o),r.Cartesian3.normalize(C,C);var l=K;l.x=r.Cartesian3.dot(e,i),l.y=r.Cartesian3.dot(e,o),l.z=r.Cartesian3.dot(e,C);var h,x=0;return l.x<-c?x+=(h=l.x+c)*h:l.x>c&&(x+=(h=l.x-c)*h),l.y<-u?x+=(h=l.y+u)*h:l.y>u&&(x+=(h=l.y-u)*h),l.z<-d?x+=(h=l.z+d)*h:l.z>d&&(x+=(h=l.z-d)*h),x};var Q=new r.Cartesian3,$=new r.Cartesian3;u.computePlaneDistances=function(a,e,n,o){t.defined(o)||(o=new i.Interval);var C=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,u=a.center,d=a.halfAxes,l=s.Matrix3.getColumn(d,0,Y),h=s.Matrix3.getColumn(d,1,H),x=s.Matrix3.getColumn(d,2,J),M=r.Cartesian3.add(l,h,Q);r.Cartesian3.add(M,x,M),r.Cartesian3.add(M,u,M);var m=r.Cartesian3.subtract(M,e,$),f=r.Cartesian3.dot(n,m);return C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.add(u,l,M),r.Cartesian3.add(M,h,M),r.Cartesian3.subtract(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.add(u,l,M),r.Cartesian3.subtract(M,h,M),r.Cartesian3.add(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.add(u,l,M),r.Cartesian3.subtract(M,h,M),r.Cartesian3.subtract(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.subtract(u,l,M),r.Cartesian3.add(M,h,M),r.Cartesian3.add(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.subtract(u,l,M),r.Cartesian3.add(M,h,M),r.Cartesian3.subtract(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.subtract(u,l,M),r.Cartesian3.subtract(M,h,M),r.Cartesian3.add(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),r.Cartesian3.subtract(u,l,M),r.Cartesian3.subtract(M,h,M),r.Cartesian3.subtract(M,x,M),r.Cartesian3.subtract(M,e,m),f=r.Cartesian3.dot(n,m),C=Math.min(f,C),c=Math.max(f,c),o.start=C,o.stop=c,o};var aa=new i.BoundingSphere;u.isOccluded=function(a,t){var e=i.BoundingSphere.fromOrientedBoundingBox(a,aa);return!t.isBoundingSphereVisible(e)},u.prototype.intersectPlane=function(a){return u.intersectPlane(this,a)},u.prototype.distanceSquaredTo=function(a){return u.distanceSquaredTo(this,a)},u.prototype.computePlaneDistances=function(a,t,e){return u.computePlaneDistances(this,a,t,e)},u.prototype.isOccluded=function(a){return u.isOccluded(this,a)},u.equals=function(a,e){return a===e||t.defined(a)&&t.defined(e)&&r.Cartesian3.equals(a.center,e.center)&&s.Matrix3.equals(a.halfAxes,e.halfAxes)},u.prototype.clone=function(a){return u.clone(this,a)},u.prototype.equals=function(a){return u.equals(this,a)},a.OrientedBoundingBox=u}));
