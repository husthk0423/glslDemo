define(["./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./RuntimeError-6122571f","./Rectangle-3285eeb3","./WebGLConstants-4ae0db90","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./IndexDatatype-e3260434","./GeometryOffsetAttribute-e6e9672c","./EllipsoidRhumbLine-01c8204c","./PolygonPipeline-db004fe0","./RectangleGeometryLibrary-d813e8ff"],(function(e,t,i,a,r,n,o,l,u,s,c,p,d,f,g,h,y){"use strict";var m=new r.BoundingSphere,b=new r.BoundingSphere,_=new a.Cartesian3,v=new l.Rectangle;function E(e,t){var i=e._ellipsoid,a=t.height,r=t.width,n=t.northCap,o=t.southCap,l=a,u=2,f=0,g=4;n&&(u-=1,l-=1,f+=1,g-=2),o&&(u-=1,l-=1,f+=1,g-=2),f+=u*r+2*l-g;var h,m=new Float64Array(3*f),b=0,v=0,E=_;if(n)y.RectangleGeometryLibrary.computePosition(t,i,!1,v,0,E),m[b++]=E.x,m[b++]=E.y,m[b++]=E.z;else for(h=0;h<r;h++)y.RectangleGeometryLibrary.computePosition(t,i,!1,v,h,E),m[b++]=E.x,m[b++]=E.y,m[b++]=E.z;for(h=r-1,v=1;v<a;v++)y.RectangleGeometryLibrary.computePosition(t,i,!1,v,h,E),m[b++]=E.x,m[b++]=E.y,m[b++]=E.z;if(v=a-1,!o)for(h=r-2;h>=0;h--)y.RectangleGeometryLibrary.computePosition(t,i,!1,v,h,E),m[b++]=E.x,m[b++]=E.y,m[b++]=E.z;for(h=0,v=a-2;v>0;v--)y.RectangleGeometryLibrary.computePosition(t,i,!1,v,h,E),m[b++]=E.x,m[b++]=E.y,m[b++]=E.z;for(var A=m.length/3*2,G=d.IndexDatatype.createTypedArray(m.length/3,A),R=0,P=0;P<m.length/3-1;P++)G[R++]=P,G[R++]=P+1;G[R++]=m.length/3-1,G[R++]=0;var w=new c.Geometry({attributes:new p.GeometryAttributes,primitiveType:c.PrimitiveType.LINES});return w.attributes.position=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m}),w.indices=G,w}function A(t){var r=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).rectangle,n=e.defaultValue(t.granularity,i.CesiumMath.RADIANS_PER_DEGREE),o=e.defaultValue(t.ellipsoid,a.Ellipsoid.WGS84),u=e.defaultValue(t.rotation,0),s=e.defaultValue(t.height,0),c=e.defaultValue(t.extrudedHeight,s);this._rectangle=l.Rectangle.clone(r),this._granularity=n,this._ellipsoid=o,this._surfaceHeight=Math.max(s,c),this._rotation=u,this._extrudedHeight=Math.min(s,c),this._offsetAttribute=t.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}A.packedLength=l.Rectangle.packedLength+a.Ellipsoid.packedLength+5,A.pack=function(t,i,r){return r=e.defaultValue(r,0),l.Rectangle.pack(t._rectangle,i,r),r+=l.Rectangle.packedLength,a.Ellipsoid.pack(t._ellipsoid,i,r),r+=a.Ellipsoid.packedLength,i[r++]=t._granularity,i[r++]=t._surfaceHeight,i[r++]=t._rotation,i[r++]=t._extrudedHeight,i[r]=e.defaultValue(t._offsetAttribute,-1),i};var G=new l.Rectangle,R=a.Ellipsoid.clone(a.Ellipsoid.UNIT_SPHERE),P={rectangle:G,ellipsoid:R,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};A.unpack=function(t,i,r){i=e.defaultValue(i,0);var n=l.Rectangle.unpack(t,i,G);i+=l.Rectangle.packedLength;var o=a.Ellipsoid.unpack(t,i,R);i+=a.Ellipsoid.packedLength;var u=t[i++],s=t[i++],c=t[i++],p=t[i++],d=t[i];return e.defined(r)?(r._rectangle=l.Rectangle.clone(n,r._rectangle),r._ellipsoid=a.Ellipsoid.clone(o,r._ellipsoid),r._surfaceHeight=s,r._rotation=c,r._extrudedHeight=p,r._offsetAttribute=-1===d?void 0:d,r):(P.granularity=u,P.height=s,P.rotation=c,P.extrudedHeight=p,P.offsetAttribute=-1===d?void 0:d,new A(P))};var w=new a.Cartographic;return A.createGeometry=function(t){var a,n,o=t._rectangle,l=t._ellipsoid,u=y.RectangleGeometryLibrary.computeOptions(o,t._granularity,t._rotation,0,v,w);if(!i.CesiumMath.equalsEpsilon(o.north,o.south,i.CesiumMath.EPSILON10)&&!i.CesiumMath.equalsEpsilon(o.east,o.west,i.CesiumMath.EPSILON10)){var p,g=t._surfaceHeight,_=t._extrudedHeight;if(!i.CesiumMath.equalsEpsilon(g,_,0,i.CesiumMath.EPSILON2)){if(a=function(e,t){var i=e._surfaceHeight,a=e._extrudedHeight,r=e._ellipsoid,n=a,o=i,l=E(e,t),u=t.height,s=t.width,c=h.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,o,r,!1),p=c.length,f=new Float64Array(2*p);f.set(c);var g=h.PolygonPipeline.scaleToGeodeticHeight(l.attributes.position.values,n,r);f.set(g,p),l.attributes.position.values=f;var y=t.northCap,m=t.southCap,b=4;y&&(b-=1),m&&(b-=1);var _=2*(f.length/3+b),v=d.IndexDatatype.createTypedArray(f.length/3,_);p=f.length/6;for(var A,G=0,R=0;R<p-1;R++)v[G++]=R,v[G++]=R+1,v[G++]=R+p,v[G++]=R+p+1;if(v[G++]=p-1,v[G++]=0,v[G++]=p+p-1,v[G++]=p,v[G++]=0,v[G++]=p,y)A=u-1;else{var P=s-1;v[G++]=P,v[G++]=P+p,A=s+u-2}if(v[G++]=A,v[G++]=A+p,!m){var w=s+A-1;v[G++]=w,v[G]=w+p}return l.indices=v,l}(t,u),e.defined(t._offsetAttribute)){var A=a.attributes.position.values.length/3,G=new Uint8Array(A);t._offsetAttribute===f.GeometryOffsetAttribute.TOP?G=f.arrayFill(G,1,0,A/2):(p=t._offsetAttribute===f.GeometryOffsetAttribute.NONE?0:1,G=f.arrayFill(G,p)),a.attributes.applyOffset=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:G})}var R=r.BoundingSphere.fromRectangle3D(o,l,g,b),P=r.BoundingSphere.fromRectangle3D(o,l,_,m);n=r.BoundingSphere.union(R,P)}else{if((a=E(t,u)).attributes.position.values=h.PolygonPipeline.scaleToGeodeticHeight(a.attributes.position.values,g,l,!1),e.defined(t._offsetAttribute)){var L=a.attributes.position.values.length,C=new Uint8Array(L/3);p=t._offsetAttribute===f.GeometryOffsetAttribute.NONE?0:1,f.arrayFill(C,p),a.attributes.applyOffset=new c.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:C})}n=r.BoundingSphere.fromRectangle3D(o,l,g)}return new c.Geometry({attributes:a.attributes,indices:a.indices,primitiveType:c.PrimitiveType.LINES,boundingSphere:n,offsetAttribute:t._offsetAttribute})}},function(t,i){return e.defined(i)&&(t=A.unpack(t,i)),t._ellipsoid=a.Ellipsoid.clone(t._ellipsoid),t._rectangle=l.Rectangle.clone(t._rectangle),A.createGeometry(t)}}));
