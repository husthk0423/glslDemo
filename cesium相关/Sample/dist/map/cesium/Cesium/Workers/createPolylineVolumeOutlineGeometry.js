define(["./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./RuntimeError-6122571f","./Rectangle-3285eeb3","./WebGLConstants-4ae0db90","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./IndexDatatype-e3260434","./IntersectionTests-525ff5aa","./Plane-dbdf17bf","./arrayRemoveDuplicates-a580a060","./BoundingRectangle-f5c8097c","./EllipsoidTangentPlane-98a8a37e","./EllipsoidRhumbLine-01c8204c","./PolygonPipeline-db004fe0","./PolylineVolumeGeometryLibrary-f67be923","./EllipsoidGeodesic-c0017f17","./PolylinePipeline-b34abe5b"],(function(e,i,n,t,a,r,o,l,s,p,d,c,u,y,f,h,g,m,v,E,P,_,b){"use strict";function k(i){var a=(i=e.defaultValue(i,e.defaultValue.EMPTY_OBJECT)).polylinePositions,r=i.shapePositions;this._positions=a,this._shape=r,this._ellipsoid=t.Ellipsoid.clone(e.defaultValue(i.ellipsoid,t.Ellipsoid.WGS84)),this._cornerType=e.defaultValue(i.cornerType,P.CornerType.ROUNDED),this._granularity=e.defaultValue(i.granularity,n.CesiumMath.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var o=1+a.length*t.Cartesian3.packedLength;o+=1+r.length*t.Cartesian2.packedLength,this.packedLength=o+t.Ellipsoid.packedLength+2}k.pack=function(i,n,a){var r;a=e.defaultValue(a,0);var o=i._positions,l=o.length;for(n[a++]=l,r=0;r<l;++r,a+=t.Cartesian3.packedLength)t.Cartesian3.pack(o[r],n,a);var s=i._shape;for(l=s.length,n[a++]=l,r=0;r<l;++r,a+=t.Cartesian2.packedLength)t.Cartesian2.pack(s[r],n,a);return t.Ellipsoid.pack(i._ellipsoid,n,a),a+=t.Ellipsoid.packedLength,n[a++]=i._cornerType,n[a]=i._granularity,n};var C=t.Ellipsoid.clone(t.Ellipsoid.UNIT_SPHERE),L={polylinePositions:void 0,shapePositions:void 0,ellipsoid:C,height:void 0,cornerType:void 0,granularity:void 0};k.unpack=function(i,n,a){var r;n=e.defaultValue(n,0);var o=i[n++],l=new Array(o);for(r=0;r<o;++r,n+=t.Cartesian3.packedLength)l[r]=t.Cartesian3.unpack(i,n);o=i[n++];var s=new Array(o);for(r=0;r<o;++r,n+=t.Cartesian2.packedLength)s[r]=t.Cartesian2.unpack(i,n);var p=t.Ellipsoid.unpack(i,n,C);n+=t.Ellipsoid.packedLength;var d=i[n++],c=i[n];return e.defined(a)?(a._positions=l,a._shape=s,a._ellipsoid=t.Ellipsoid.clone(p,a._ellipsoid),a._cornerType=d,a._granularity=c,a):(L.polylinePositions=l,L.shapePositions=s,L.cornerType=d,L.granularity=c,new k(L))};var T=new g.BoundingRectangle;return k.createGeometry=function(e){var i=e._positions,n=h.arrayRemoveDuplicates(i,t.Cartesian3.equalsEpsilon),r=e._shape;if(r=P.PolylineVolumeGeometryLibrary.removeDuplicatesFromShape(r),!(n.length<2||r.length<3)){E.PolygonPipeline.computeWindingOrder2D(r)===E.WindingOrder.CLOCKWISE&&r.reverse();var o=g.BoundingRectangle.fromPoints(r,T);return function(e,i){var n=new c.GeometryAttributes;n.position=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e});var t,r,o=i.length,l=n.position.values.length/3,s=e.length/3/o,y=u.IndexDatatype.createTypedArray(l,2*o*(s+1)),f=0,h=(t=0)*o;for(r=0;r<o-1;r++)y[f++]=r+h,y[f++]=r+h+1;for(y[f++]=o-1+h,y[f++]=h,h=(t=s-1)*o,r=0;r<o-1;r++)y[f++]=r+h,y[f++]=r+h+1;for(y[f++]=o-1+h,y[f++]=h,t=0;t<s-1;t++){var g=o*t,m=g+o;for(r=0;r<o;r++)y[f++]=r+g,y[f++]=r+m}return new d.Geometry({attributes:n,indices:u.IndexDatatype.createTypedArray(l,y),boundingSphere:a.BoundingSphere.fromVertices(e),primitiveType:d.PrimitiveType.LINES})}(P.PolylineVolumeGeometryLibrary.computePositions(n,r,o,e,!1),r)}},function(i,n){return e.defined(n)&&(i=k.unpack(i,n)),i._ellipsoid=t.Ellipsoid.clone(i._ellipsoid),k.createGeometry(i)}}));
