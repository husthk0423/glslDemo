define(["exports","./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./GeometryPipeline-01c9df66","./IndexDatatype-e3260434","./GeometryOffsetAttribute-e6e9672c","./GeometryInstance-b1e4a9ef","./EllipsoidTangentPlane-98a8a37e","./ArcType-29cf2197","./PolygonPipeline-db004fe0","./PolygonGeometryLibrary-d78156f9"],(function(e,t,i,r,o,n,a,y,l,s,u,p,d,g,f,c,h){"use strict";var m=[],b=[];function P(e,t,i,r,o){var n,s,p=g.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,m);c.PolygonPipeline.computeWindingOrder2D(p)===c.WindingOrder.CLOCKWISE&&(p.reverse(),t=t.slice().reverse());var P=t.length,v=0;if(r)for(n=new Float64Array(2*P*3),s=0;s<P;s++){var A=t[s],E=t[(s+1)%P];n[v++]=A.x,n[v++]=A.y,n[v++]=A.z,n[v++]=E.x,n[v++]=E.y,n[v++]=E.z}else{var _=0;if(o===f.ArcType.GEODESIC)for(s=0;s<P;s++)_+=h.PolygonGeometryLibrary.subdivideLineCount(t[s],t[(s+1)%P],i);else if(o===f.ArcType.RHUMB)for(s=0;s<P;s++)_+=h.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[s],t[(s+1)%P],i);for(n=new Float64Array(3*_),s=0;s<P;s++){var G;o===f.ArcType.GEODESIC?G=h.PolygonGeometryLibrary.subdivideLine(t[s],t[(s+1)%P],i,b):o===f.ArcType.RHUMB&&(G=h.PolygonGeometryLibrary.subdivideRhumbLine(e,t[s],t[(s+1)%P],i,b));for(var H=G.length,L=0;L<H;++L)n[v++]=G[L]}}var T=2*(P=n.length/3),O=u.IndexDatatype.createTypedArray(P,T);for(v=0,s=0;s<P-1;s++)O[v++]=s,O[v++]=s+1;return O[v++]=P-1,O[v++]=0,new d.GeometryInstance({geometry:new y.Geometry({attributes:new l.GeometryAttributes({position:new y.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:O,primitiveType:y.PrimitiveType.LINES})})}function v(e,t,i,r,o){var n,s,p=g.EllipsoidTangentPlane.fromPoints(t,e).projectPointsOntoPlane(t,m);c.PolygonPipeline.computeWindingOrder2D(p)===c.WindingOrder.CLOCKWISE&&(p.reverse(),t=t.slice().reverse());var P=t.length,v=new Array(P),A=0;if(r)for(n=new Float64Array(2*P*3*2),s=0;s<P;++s){v[s]=A/3;var E=t[s],_=t[(s+1)%P];n[A++]=E.x,n[A++]=E.y,n[A++]=E.z,n[A++]=_.x,n[A++]=_.y,n[A++]=_.z}else{var G=0;if(o===f.ArcType.GEODESIC)for(s=0;s<P;s++)G+=h.PolygonGeometryLibrary.subdivideLineCount(t[s],t[(s+1)%P],i);else if(o===f.ArcType.RHUMB)for(s=0;s<P;s++)G+=h.PolygonGeometryLibrary.subdivideRhumbLineCount(e,t[s],t[(s+1)%P],i);for(n=new Float64Array(3*G*2),s=0;s<P;++s){var H;v[s]=A/3,o===f.ArcType.GEODESIC?H=h.PolygonGeometryLibrary.subdivideLine(t[s],t[(s+1)%P],i,b):o===f.ArcType.RHUMB&&(H=h.PolygonGeometryLibrary.subdivideRhumbLine(e,t[s],t[(s+1)%P],i,b));for(var L=H.length,T=0;T<L;++T)n[A++]=H[T]}}P=n.length/6;var O=v.length,x=2*(2*P+O),C=u.IndexDatatype.createTypedArray(P+O,x);for(A=0,s=0;s<P;++s)C[A++]=s,C[A++]=(s+1)%P,C[A++]=s+P,C[A++]=(s+1)%P+P;for(s=0;s<O;s++){var D=v[s];C[A++]=D,C[A++]=D+P}return new d.GeometryInstance({geometry:new y.Geometry({attributes:new l.GeometryAttributes({position:new y.GeometryAttribute({componentDatatype:a.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:n})}),indices:C,primitiveType:y.PrimitiveType.LINES})})}function A(e){var i=e.polygonHierarchy,n=t.defaultValue(e.ellipsoid,o.Ellipsoid.WGS84),a=t.defaultValue(e.granularity,r.CesiumMath.RADIANS_PER_DEGREE),y=t.defaultValue(e.perPositionHeight,!1),l=y&&t.defined(e.extrudedHeight),s=t.defaultValue(e.arcType,f.ArcType.GEODESIC),u=t.defaultValue(e.height,0),p=t.defaultValue(e.extrudedHeight,u);if(!l){var d=Math.max(u,p);p=Math.min(u,p),u=d}this._ellipsoid=o.Ellipsoid.clone(n),this._granularity=a,this._height=u,this._extrudedHeight=p,this._arcType=s,this._polygonHierarchy=i,this._perPositionHeight=y,this._perPositionHeightExtrude=l,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=h.PolygonGeometryLibrary.computeHierarchyPackedLength(i)+o.Ellipsoid.packedLength+8}A.pack=function(e,i,r){return r=t.defaultValue(r,0),r=h.PolygonGeometryLibrary.packPolygonHierarchy(e._polygonHierarchy,i,r),o.Ellipsoid.pack(e._ellipsoid,i,r),r+=o.Ellipsoid.packedLength,i[r++]=e._height,i[r++]=e._extrudedHeight,i[r++]=e._granularity,i[r++]=e._perPositionHeightExtrude?1:0,i[r++]=e._perPositionHeight?1:0,i[r++]=e._arcType,i[r++]=t.defaultValue(e._offsetAttribute,-1),i[r]=e.packedLength,i};var E=o.Ellipsoid.clone(o.Ellipsoid.UNIT_SPHERE),_={polygonHierarchy:{}};A.unpack=function(e,i,r){i=t.defaultValue(i,0);var n=h.PolygonGeometryLibrary.unpackPolygonHierarchy(e,i);i=n.startingIndex,delete n.startingIndex;var a=o.Ellipsoid.unpack(e,i,E);i+=o.Ellipsoid.packedLength;var y=e[i++],l=e[i++],s=e[i++],u=1===e[i++],p=1===e[i++],d=e[i++],g=e[i++],f=e[i];return t.defined(r)||(r=new A(_)),r._polygonHierarchy=n,r._ellipsoid=o.Ellipsoid.clone(a,r._ellipsoid),r._height=y,r._extrudedHeight=l,r._granularity=s,r._perPositionHeight=p,r._perPositionHeightExtrude=u,r._arcType=d,r._offsetAttribute=-1===g?void 0:g,r.packedLength=f,r},A.fromPositions=function(e){return new A({polygonHierarchy:{positions:(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT)).positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},A.createGeometry=function(e){var i=e._ellipsoid,o=e._granularity,l=e._polygonHierarchy,u=e._perPositionHeight,d=e._arcType,g=h.PolygonGeometryLibrary.polygonOutlinesFromHierarchy(l,!u,i);if(0!==g.length){var f,m,b,A=[],E=r.CesiumMath.chordLength(o,i.maximumRadius),_=e._height,G=e._extrudedHeight;if(e._perPositionHeightExtrude||!r.CesiumMath.equalsEpsilon(_,G,0,r.CesiumMath.EPSILON2))for(b=0;b<g.length;b++){if((f=v(i,g[b],E,u,d)).geometry=h.PolygonGeometryLibrary.scaleToGeodeticHeightExtruded(f.geometry,_,G,i,u),t.defined(e._offsetAttribute)){var H=f.geometry.attributes.position.values.length/3,L=new Uint8Array(H);e._offsetAttribute===p.GeometryOffsetAttribute.TOP?L=p.arrayFill(L,1,0,H/2):(m=e._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,L=p.arrayFill(L,m)),f.geometry.attributes.applyOffset=new y.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:L})}A.push(f)}else for(b=0;b<g.length;b++){if((f=P(i,g[b],E,u,d)).geometry.attributes.position.values=c.PolygonPipeline.scaleToGeodeticHeight(f.geometry.attributes.position.values,_,i,!u),t.defined(e._offsetAttribute)){var T=f.geometry.attributes.position.values.length,O=new Uint8Array(T/3);m=e._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1,p.arrayFill(O,m),f.geometry.attributes.applyOffset=new y.GeometryAttribute({componentDatatype:a.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:O})}A.push(f)}var x=s.GeometryPipeline.combineInstances(A)[0],C=n.BoundingSphere.fromVertices(x.attributes.position.values);return new y.Geometry({attributes:x.attributes,indices:x.indices,primitiveType:x.primitiveType,boundingSphere:C,offsetAttribute:e._offsetAttribute})}},e.PolygonOutlineGeometry=A}));
