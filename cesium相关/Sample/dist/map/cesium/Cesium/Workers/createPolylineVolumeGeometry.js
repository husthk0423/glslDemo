define(["./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./Transforms-8b7e0d39","./RuntimeError-6122571f","./Rectangle-3285eeb3","./WebGLConstants-4ae0db90","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./AttributeCompression-72a6590f","./GeometryPipeline-01c9df66","./EncodedCartesian3-4f87492e","./IndexDatatype-e3260434","./IntersectionTests-525ff5aa","./Plane-dbdf17bf","./VertexFormat-ad523db1","./arrayRemoveDuplicates-a580a060","./BoundingRectangle-f5c8097c","./EllipsoidTangentPlane-98a8a37e","./EllipsoidRhumbLine-01c8204c","./PolygonPipeline-db004fe0","./PolylineVolumeGeometryLibrary-f67be923","./EllipsoidGeodesic-c0017f17","./PolylinePipeline-b34abe5b"],(function(e,t,n,r,i,a,o,l,s,p,d,c,u,g,y,m,h,f,v,b,E,P,_,x,k,C,V){"use strict";var L={};function w(t,n){e.defined(L[t])||(L[t]=!0,console.warn(e.defaultValue(n,t)))}function F(t){var i=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).polylinePositions,a=t.shapePositions;this._positions=i,this._shape=a,this._ellipsoid=r.Ellipsoid.clone(e.defaultValue(t.ellipsoid,r.Ellipsoid.WGS84)),this._cornerType=e.defaultValue(t.cornerType,k.CornerType.ROUNDED),this._vertexFormat=v.VertexFormat.clone(e.defaultValue(t.vertexFormat,v.VertexFormat.DEFAULT)),this._granularity=e.defaultValue(t.granularity,n.CesiumMath.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var o=1+i.length*r.Cartesian3.packedLength;o+=1+a.length*r.Cartesian2.packedLength,this.packedLength=o+r.Ellipsoid.packedLength+v.VertexFormat.packedLength+2}w.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",w.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",w.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",w.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored",F.pack=function(t,n,i){var a;i=e.defaultValue(i,0);var o=t._positions,l=o.length;for(n[i++]=l,a=0;a<l;++a,i+=r.Cartesian3.packedLength)r.Cartesian3.pack(o[a],n,i);var s=t._shape;for(l=s.length,n[i++]=l,a=0;a<l;++a,i+=r.Cartesian2.packedLength)r.Cartesian2.pack(s[a],n,i);return r.Ellipsoid.pack(t._ellipsoid,n,i),i+=r.Ellipsoid.packedLength,v.VertexFormat.pack(t._vertexFormat,n,i),i+=v.VertexFormat.packedLength,n[i++]=t._cornerType,n[i]=t._granularity,n};var T=r.Ellipsoid.clone(r.Ellipsoid.UNIT_SPHERE),G=new v.VertexFormat,R={polylinePositions:void 0,shapePositions:void 0,ellipsoid:T,vertexFormat:G,cornerType:void 0,granularity:void 0};F.unpack=function(t,n,i){var a;n=e.defaultValue(n,0);var o=t[n++],l=new Array(o);for(a=0;a<o;++a,n+=r.Cartesian3.packedLength)l[a]=r.Cartesian3.unpack(t,n);o=t[n++];var s=new Array(o);for(a=0;a<o;++a,n+=r.Cartesian2.packedLength)s[a]=r.Cartesian2.unpack(t,n);var p=r.Ellipsoid.unpack(t,n,T);n+=r.Ellipsoid.packedLength;var d=v.VertexFormat.unpack(t,n,G);n+=v.VertexFormat.packedLength;var c=t[n++],u=t[n];return e.defined(i)?(i._positions=l,i._shape=s,i._ellipsoid=r.Ellipsoid.clone(p,i._ellipsoid),i._vertexFormat=v.VertexFormat.clone(d,i._vertexFormat),i._cornerType=c,i._granularity=u,i):(R.polylinePositions=l,R.shapePositions=s,R.cornerType=c,R.granularity=u,new F(R))};var A=new E.BoundingRectangle;return F.createGeometry=function(e){var t=e._positions,n=b.arrayRemoveDuplicates(t,r.Cartesian3.equalsEpsilon),a=e._shape;if(a=k.PolylineVolumeGeometryLibrary.removeDuplicatesFromShape(a),!(n.length<2||a.length<3)){x.PolygonPipeline.computeWindingOrder2D(a)===x.WindingOrder.CLOCKWISE&&a.reverse();var o=E.BoundingRectangle.fromPoints(a,A);return function(e,t,n,r){var a=new c.GeometryAttributes;r.position&&(a.position=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:e}));var o,l,s,u,y,h,f=t.length,v=e.length/3,b=(v-2*f)/(2*f),E=x.PolygonPipeline.triangulate(t),P=(b-1)*f*6+2*E.length,_=m.IndexDatatype.createTypedArray(v,P),k=2*f,C=0;for(o=0;o<b-1;o++){for(l=0;l<f-1;l++)h=(s=2*l+o*f*2)+k,y=(u=s+1)+k,_[C++]=u,_[C++]=s,_[C++]=y,_[C++]=y,_[C++]=s,_[C++]=h;y=(u=1+(s=2*f-2+o*f*2))+k,h=s+k,_[C++]=u,_[C++]=s,_[C++]=y,_[C++]=y,_[C++]=s,_[C++]=h}if(r.st||r.tangent||r.bitangent){var V,L,F=new Float32Array(2*v),T=1/(b-1),G=1/n.height,R=n.height/2,A=0;for(o=0;o<b;o++){for(V=o*T,L=G*(t[0].y+R),F[A++]=V,F[A++]=L,l=1;l<f;l++)L=G*(t[l].y+R),F[A++]=V,F[A++]=L,F[A++]=V,F[A++]=L;L=G*(t[0].y+R),F[A++]=V,F[A++]=L}for(l=0;l<f;l++)V=0,L=G*(t[l].y+R),F[A++]=V,F[A++]=L;for(l=0;l<f;l++)V=(b-1)*T,L=G*(t[l].y+R),F[A++]=V,F[A++]=L;a.st=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array(F)})}var D=v-2*f;for(o=0;o<E.length;o+=3){var I=E[o]+D,O=E[o+1]+D,S=E[o+2]+D;_[C++]=I,_[C++]=O,_[C++]=S,_[C++]=S+f,_[C++]=O+f,_[C++]=I+f}var B=new d.Geometry({attributes:a,indices:_,boundingSphere:i.BoundingSphere.fromVertices(e),primitiveType:d.PrimitiveType.TRIANGLES});if(r.normal&&(B=g.GeometryPipeline.computeNormal(B)),r.tangent||r.bitangent){try{B=g.GeometryPipeline.computeTangentAndBitangent(B)}catch(e){w("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}r.tangent||(B.attributes.tangent=void 0),r.bitangent||(B.attributes.bitangent=void 0),r.st||(B.attributes.st=void 0)}return B}(k.PolylineVolumeGeometryLibrary.computePositions(n,a,o,e,!0),a,o,e._vertexFormat)}},function(t,n){return e.defined(n)&&(t=F.unpack(t,n)),t._ellipsoid=r.Ellipsoid.clone(t._ellipsoid),F.createGeometry(t)}}));
