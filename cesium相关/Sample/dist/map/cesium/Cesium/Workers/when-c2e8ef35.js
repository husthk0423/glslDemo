define(["exports"],(function(n){"use strict";function r(n,r){return null!=n?n:r}
/**
      @license
      when.js - https://github.com/cujojs/when

      MIT License (c) copyright B Cavalier & J Hann

     * A lightweight CommonJS Promises/A and when() implementation
     * when is part of the cujo.js family of libraries (http://cujojs.com/)
     *
     * Licensed under the MIT License at:
     * http://www.opensource.org/licenses/mit-license.php
     *
     * @version 1.7.1
     */
var t,e,u;function o(n,r,t,e){return i(n).then(r,t,e)}function i(n){var r,t,e;return n instanceof c?r=n:h(n)?(t=s(),n.then((function(n){t.resolve(n)}),(function(n){t.reject(n)}),(function(n){t.progress(n)})),r=t.promise):(e=n,r=new c((function(n){try{return i(n?n(e):e)}catch(n){return f(n)}}))),r}function c(n){this.then=n}function f(n){return new c((function(r,t){try{return t?i(t(n)):f(n)}catch(n){return f(n)}}))}function s(){var n,r,t,e,o,h;return n=new c(l),r=[],t=[],e=function(n,e,u){var o,i;return o=s(),i="function"==typeof u?function(n){try{o.progress(u(n))}catch(n){o.progress(n)}}:function(n){o.progress(n)},r.push((function(r){r.then(n,e).then(o.resolve,o.reject,i)})),t.push(i),o.promise},o=function(n){return v(t,n),n},h=function(n){return n=i(n),e=n.then,h=i,o=y,v(r,n),t=r=u,n},{then:l,resolve:a,reject:p,progress:g,promise:n,resolver:{resolve:a,reject:p,progress:g}};function l(n,r,t){return e(n,r,t)}function a(n){return h(n)}function p(n){return h(f(n))}function g(n){return o(n)}}function h(n){return n&&"function"==typeof n.then}function l(n,r,t,e,u){return g(2,arguments),o(n,(function(n){var i,c,f,h,l,a,p,v,g,j;if(g=n.length>>>0,i=Math.max(0,Math.min(r,g)),f=[],c=g-i+1,h=[],l=s(),i)for(v=l.progress,p=function(n){h.push(n),--c||(a=p=y,l.reject(h))},a=function(n){f.push(n),--i||(a=p=y,l.resolve(f))},j=0;j<g;++j)j in n&&o(n[j],w,m,v);else l.resolve(f);return l.then(t,e,u);function m(n){p(n)}function w(n){a(n)}}))}function a(n,r,t,e){return g(1,arguments),p(n,j).then(r,t,e)}function p(n,r){return o(n,(function(n){var t,e,u,i,c,f;if(u=e=n.length>>>0,t=[],f=s(),u)for(i=function(n,e){o(n,r).then((function(n){t[e]=n,--u||f.resolve(t)}),f.reject)},c=0;c<e;c++)c in n?i(n[c],c):--u;else f.resolve(t);return f.promise}))}function v(n,r){for(var t,e=0;t=n[e++];)t(r)}function g(n,r){for(var t,e=r.length;e>n;)if(null!=(t=r[--e])&&"function"!=typeof t)throw new Error("arg "+e+" must be a function")}function y(){}function j(n){return n}r.EMPTY_OBJECT=Object.freeze({}),o.defer=s,o.resolve=i,o.reject=function(n){return o(n,f)},o.join=function(){return p(arguments,j)},o.all=a,o.map=p,o.reduce=function(n,r){var u=e.call(arguments,1);return o(n,(function(n){var e;return e=n.length,u[0]=function(n,t,u){return o(n,(function(n){return o(t,(function(t){return r(n,t,u,e)}))}))},t.apply(n,u)}))},o.any=function(n,r,t,e){return l(n,1,(function(n){return r?r(n[0]):n[0]}),t,e)},o.some=l,o.chain=function(n,r,t){var e=arguments.length>2;return o(n,(function(n){return n=e?t:n,r.resolve(n),n}),(function(n){return r.reject(n),f(n)}),r.progress)},o.isPromise=h,c.prototype={always:function(n,r){return this.then(n,n,r)},otherwise:function(n){return this.then(u,n)},yield:function(n){return this.then((function(){return n}))},spread:function(n){return this.then((function(r){return a(r,(function(r){return n.apply(u,r)}))}))}},e=[].slice,t=[].reduce||function(n){var r,t,e,u,o;if(o=0,u=(r=Object(this)).length>>>0,(t=arguments).length<=1)for(;;){if(o in r){e=r[o++];break}if(++o>=u)throw new TypeError}else e=t[1];for(;o<u;++o)o in r&&(e=n(e,r[o],o,r));return e},n.defaultValue=r,n.defined=function(n){return null!=n},n.when=o}));
