define(["exports","./when-c2e8ef35","./Check-c4f3a3fc","./Math-d30358ed","./Cartesian2-f9492f23","./BoundingSphere-dcb1d5fc","./ComponentDatatype-5d3f6452","./GeometryAttribute-a5c051b9","./GeometryAttributes-57608efc","./IndexDatatype-e3260434","./GeometryOffsetAttribute-e6e9672c","./VertexFormat-ad523db1","./CylinderGeometryLibrary-95411284"],(function(t,e,a,r,n,o,i,s,u,m,d,f,p){"use strict";var y=new n.Cartesian2,l=new n.Cartesian3,c=new n.Cartesian3,b=new n.Cartesian3,v=new n.Cartesian3;function A(t){var a=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).length,r=t.topRadius,n=t.bottomRadius,o=e.defaultValue(t.vertexFormat,f.VertexFormat.DEFAULT),i=e.defaultValue(t.slices,128);this._length=a,this._topRadius=r,this._bottomRadius=n,this._vertexFormat=f.VertexFormat.clone(o),this._slices=i,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}A.packedLength=f.VertexFormat.packedLength+5,A.pack=function(t,a,r){return r=e.defaultValue(r,0),f.VertexFormat.pack(t._vertexFormat,a,r),r+=f.VertexFormat.packedLength,a[r++]=t._length,a[r++]=t._topRadius,a[r++]=t._bottomRadius,a[r++]=t._slices,a[r]=e.defaultValue(t._offsetAttribute,-1),a};var g,h=new f.VertexFormat,x={vertexFormat:h,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};A.unpack=function(t,a,r){a=e.defaultValue(a,0);var n=f.VertexFormat.unpack(t,a,h);a+=f.VertexFormat.packedLength;var o=t[a++],i=t[a++],s=t[a++],u=t[a++],m=t[a];return e.defined(r)?(r._vertexFormat=f.VertexFormat.clone(n,r._vertexFormat),r._length=o,r._topRadius=i,r._bottomRadius=s,r._slices=u,r._offsetAttribute=-1===m?void 0:m,r):(x.length=o,x.topRadius=i,x.bottomRadius=s,x.slices=u,x.offsetAttribute=-1===m?void 0:m,new A(x))},A.createGeometry=function(t){var a=t._length,f=t._topRadius,A=t._bottomRadius,g=t._vertexFormat,h=t._slices;if(!(a<=0||f<0||A<0||0===f&&0===A)){var x,_=h+h,C=h+_,F=_+_,w=p.CylinderGeometryLibrary.computePositions(a,f,A,h,!0),G=g.st?new Float32Array(2*F):void 0,D=g.normal?new Float32Array(3*F):void 0,R=g.tangent?new Float32Array(3*F):void 0,V=g.bitangent?new Float32Array(3*F):void 0,O=g.normal||g.tangent||g.bitangent;if(O){var T=g.tangent||g.bitangent,L=0,P=0,k=0,M=Math.atan2(A-f,a),z=l;z.z=Math.sin(M);var E=Math.cos(M),N=b,I=c;for(x=0;x<h;x++){var S=x/h*r.CesiumMath.TWO_PI,U=E*Math.cos(S),B=E*Math.sin(S);O&&(z.x=U,z.y=B,T&&(N=n.Cartesian3.normalize(n.Cartesian3.cross(n.Cartesian3.UNIT_Z,z,N),N)),g.normal&&(D[L++]=z.x,D[L++]=z.y,D[L++]=z.z,D[L++]=z.x,D[L++]=z.y,D[L++]=z.z),g.tangent&&(R[P++]=N.x,R[P++]=N.y,R[P++]=N.z,R[P++]=N.x,R[P++]=N.y,R[P++]=N.z),g.bitangent&&(I=n.Cartesian3.normalize(n.Cartesian3.cross(z,N,I),I),V[k++]=I.x,V[k++]=I.y,V[k++]=I.z,V[k++]=I.x,V[k++]=I.y,V[k++]=I.z))}for(x=0;x<h;x++)g.normal&&(D[L++]=0,D[L++]=0,D[L++]=-1),g.tangent&&(R[P++]=1,R[P++]=0,R[P++]=0),g.bitangent&&(V[k++]=0,V[k++]=-1,V[k++]=0);for(x=0;x<h;x++)g.normal&&(D[L++]=0,D[L++]=0,D[L++]=1),g.tangent&&(R[P++]=1,R[P++]=0,R[P++]=0),g.bitangent&&(V[k++]=0,V[k++]=1,V[k++]=0)}var Y=12*h-12,Z=m.IndexDatatype.createTypedArray(F,Y),J=0,W=0;for(x=0;x<h-1;x++)Z[J++]=W,Z[J++]=W+2,Z[J++]=W+3,Z[J++]=W,Z[J++]=W+3,Z[J++]=W+1,W+=2;for(Z[J++]=_-2,Z[J++]=0,Z[J++]=1,Z[J++]=_-2,Z[J++]=1,Z[J++]=_-1,x=1;x<h-1;x++)Z[J++]=_+x+1,Z[J++]=_+x,Z[J++]=_;for(x=1;x<h-1;x++)Z[J++]=C,Z[J++]=C+x,Z[J++]=C+x+1;var j=0;if(g.st){var q=Math.max(f,A);for(x=0;x<F;x++){var H=n.Cartesian3.fromArray(w,3*x,v);G[j++]=(H.x+q)/(2*q),G[j++]=(H.y+q)/(2*q)}}var K=new u.GeometryAttributes;g.position&&(K.position=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:w})),g.normal&&(K.normal=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:D})),g.tangent&&(K.tangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),g.bitangent&&(K.bitangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V})),g.st&&(K.st=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:G})),y.x=.5*a,y.y=Math.max(A,f);var Q=new o.BoundingSphere(n.Cartesian3.ZERO,n.Cartesian2.magnitude(y));if(e.defined(t._offsetAttribute)){a=w.length;var X=new Uint8Array(a/3),$=t._offsetAttribute===d.GeometryOffsetAttribute.NONE?0:1;d.arrayFill(X,$),K.applyOffset=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:X})}return new s.Geometry({attributes:K,indices:Z,primitiveType:s.PrimitiveType.TRIANGLES,boundingSphere:Q,offsetAttribute:t._offsetAttribute})}},A.getUnitCylinder=function(){return e.defined(g)||(g=A.createGeometry(new A({topRadius:1,bottomRadius:1,length:1,vertexFormat:f.VertexFormat.POSITION_ONLY}))),g},t.CylinderGeometry=A}));
